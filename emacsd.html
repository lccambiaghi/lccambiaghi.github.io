<!doctype html>
<html lang="en-us" class=scroll-smooth data-default-appearance=light data-auto-appearance=true>
  <head>
    
    <!-- Clicky -->
    <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101320555);</script>
    <script async src="//static.getclicky.com/js"></script>
    <!-- Clicky -->
    <meta charset="utf-8">
    <title>Luca's blog - Home</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Luca Cambiaghi" />
    <meta name="description" content="Luca&#39;s blog" />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://lucacambiaghi.com/static/style.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <script async src="https://talk.hyvor.com/embed/embed.js" type="module"></script>
    <script type=text/javascript src="https://lucacambiaghi.com/static//js/appearance.js"></script>
    <script defer type=text/javascript id=script-bundle src="https://lucacambiaghi.com/static//js/main.js" data-copy=Copy data-copied=Copied></script>
    
  </head>

  <body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl">
    
    <div id=the-top class="absolute flex self-center">
  <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content>
    <span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;
    </span>Skip to main content
  </a>
</div>

<header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/index.html">Luca</a></div>
<nav>
  <ul class="flex list-none sm:flex-row">
    <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
      <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/posts.html">posts</a>
    </li>
    <span class="px-2 text-primary-500">&#183;</span>
    <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
      <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/emacsd.html">emacs</a>
    </li>
    <span class="px-2 text-primary-500">&#183;</span>
    <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
      <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href="/nix.html">nix</a>
    </li>
  </ul>
</nav>
</header>

    

    <main id="main" class="relative grow">
      
<article class="page">
  <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
    Luca&#39;s emacs configuration
  </h1>
  <section class="prose dark:prose-invert">
    
<div id="outline-container-org73bf162" class="outline-2">
<h2 id="org73bf162">About this config</h2>
<div class="outline-text-2" id="text-org73bf162">
</div>
<div id="outline-container-org402c0ab" class="outline-3">
<h3 id="org402c0ab">History</h3>
<div class="outline-text-3" id="text-org402c0ab">
<p>
After using <a href="https://github.com/doomemacs/doomemacs">doom-emacs</a> for the whole of 2020, in early 2021 I wrote
<a href="https://github.com/lccambiaghi/vanilla-emacs">my own config from scratch</a>. Over 2 years I accumulated snippets and
packages until it became slow and complex. In 2023 I decided to simplify my configuration files.
</p>

<p>
Approach:
</p>
<ul class="org-ul">
<li><del>Use <a href="https://github.com/SystemCrafters/crafted-emacs">crafted-emacs</a> as a solid foundation</del>
<ul class="org-ul">
<li><del>Great <code>init.el</code> and <code>early-init.el</code></del></li>
<li><del>Solid defaults for built-in packages e.g. <code>org-mode</code></del></li>
<li><del>Great configuration of essential external packages e.g. <code>corfu</code>, <code>vertico</code>, &#x2026;</del></li>
</ul></li>
<li>Cherry-pick the essential parts of my "big" vanilla config</li>
<li>Use more of the built-in packages, <code>emacs29</code> comes with a lot of cool
stuff (<code>use-package</code>, <code>tree-sitter</code>, <code>modus-themes</code>), plus I can try
leverage more of the features introduced with emacs 27 and 28
(<code>project</code>, <code>tab-bar</code>, <code>flymake</code>, <code>eglot</code>)</li>
</ul>
</div>
</div>

<div id="outline-container-orgee202f7" class="outline-3">
<h3 id="orgee202f7">Structure</h3>
<div class="outline-text-3" id="text-orgee202f7">
<p>
Sections:
</p>
<ul class="org-ul">
<li><a href="#orga93ecf6">Emacs core settings</a>
<ul class="org-ul">
<li>Configuration with <code>(use-package emacs)</code> blocks (no external packages), variables, helpers</li>
<li>Install <code>no-littering</code></li>
<li>Load modules provided by <code>crafted-emacs</code></li>
<li>Install <code>vc-use-package</code> to add the <code>:vc</code> keyword to <code>use-package</code></li>
</ul></li>
<li><a href="#org525480e">User interface</a>
<ul class="org-ul">
<li>First <code>(use-package emacs)</code> blocks</li>
<li>Then external packages</li>
</ul></li>
<li>Packages
<ul class="org-ul">
<li><a href="#org9ca5bf5">Evil</a></li>
<li><a href="#org0bf2784">GPT interface</a></li>
<li><a href="#orgea6d0f5">Git</a></li>
<li><a href="#org8a04f10">Org mode</a></li>
<li><a href="#org77402fc">Other misc packages</a></li>
<li><a href="#org590618a">Programming languages</a></li>
</ul></li>
<li><a href="#orgcae1658">Global keybindings</a></li>
</ul>

<p>
In my previous "big" config I had organized everything into modules
but I found that I need all the packages I use and I don't need the
packages I don't use. This means I always need all modules, which
means I don't need any modules.
</p>

<p>
The only exception could the <a href="#org590618a">Programming languages</a> section,
where maybe I will only rarely need to use the <code>R</code> packages or the
<code>clojure</code> packages. If you think about it, since all packages are
deferred, they will only be loaded when needed. This means that the
only cost of keeping those sections in my config is the time spent
installing the packages on the first setup.
</p>
</div>
</div>
<div id="outline-container-orgb16ae4c" class="outline-3">
<h3 id="orgb16ae4c">Notable sections</h3>
<div class="outline-text-3" id="text-orgb16ae4c">
<p>
Here I report sections that greatly improve my productivity or that I
am particularly proud of. 
</p>

<p>
In order of appearance in my config:
</p>
<ul class="org-ul">
<li><a href="#org2f017ba">Enlarge window</a> (copied from DOOM)</li>
<li><a href="#org8f52146">Web browser in emacs</a> (requires <code>emacs</code> built with widgets support)</li>
<li><a href="#org03c4e84">Search code on github</a></li>
<li><a href="#orga832265">Jump to bookmark</a></li>
<li><a href="#orge4d57c8">Eval operator</a> (copied from DOOM)</li>
<li>evil text objects <a href="#org03424c1">for org mode</a> (code block and subtree), <a href="#org6c48f46">for outer form</a> and <a href="#org14d11c3">for buffer</a></li>
<li><a href="#org4402c30">Complete region with chatGPT</a></li>
<li><a href="#org0ddf3dd">Use org-id in links</a></li>
<li><a href="#orgac9af25">csv mode</a></li>
<li><a href="emacs.html#ID-696CB40C-C156-4200-8765-2A5195019370">dap mode</a> (<code>dap-inspect-df</code> function)</li>
<li><a href="#orgda6e1cf">jupyter</a></li>
<li><a href="#orga491c77">org-jupyter-mode</a> and <a href="#org564f3e0">scimax-jupyter</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orga93ecf6" class="outline-2">
<h2 id="orga93ecf6">Emacs core settings</h2>
<div class="outline-text-2" id="text-orga93ecf6">
</div>
<div id="outline-container-org866dfca" class="outline-3">
<h3 id="org866dfca">use-package</h3>
<div class="outline-text-3" id="text-org866dfca">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> use-package-always-ensure t)
  (<span class="org-keyword">setq</span> use-package-always-defer t)
  (<span class="org-keyword">setq</span> use-package-compute-statistics t)
  (<span class="org-keyword">setq</span> use-package-expand-minimally t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org902e6b7" class="outline-3">
<h3 id="org902e6b7">User variables</h3>
<div class="outline-text-3" id="text-org902e6b7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/config-directory</span> <span class="org-string">"~/.config/emacs/"</span>)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/use-xwidget-browser</span> nil)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/light-theme</span> 'modus-operandi)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/dark-theme</span> 'modus-vivendi)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">fix void-variable in some packages e.g. helpful</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">read-symbol-positions-list</span> nil)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/use-lambda-line</span> nil)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/use-lambda-theme</span> nil)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/copilot-enabled</span> nil)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/beorg-folder</span> <span class="org-string">"~/Library/Mobile Documents/iCloud~com~appsonthemove~beorg/Documents/beorg/"</span>)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf25e248" class="outline-3">
<h3 id="orgf25e248">Helper for tangling</h3>
<div class="outline-text-3" id="text-orgf25e248">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:hook</span>
  (org-mode . (<span class="org-keyword">lambda</span> ()
                (add-hook 'after-save-hook #'org-babel-tangle-config)))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">org-babel-tangle-config</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">when</span> (string-equal (buffer-file-name)
                        (expand-file-name <span class="org-string">"readme.org"</span> lc/config-directory))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Dynamic scoping to the rescue</span>
      (<span class="org-keyword">let</span> ((org-confirm-babel-evaluate nil))
        (org-babel-tangle)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgedd1486" class="outline-3">
<h3 id="orgedd1486">Use y-or-n</h3>
<div class="outline-text-3" id="text-orgedd1486">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> use-short-answers t))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga832265" class="outline-3">
<h3 id="orga832265">jump to bookmark</h3>
<div class="outline-text-3" id="text-orga832265">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> bookmark
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;rr"</span> . 'bookmark-set)
  (<span class="org-string">"&lt;leader&gt;rd"</span> . 'bookmark-delete)
  (<span class="org-string">"&lt;leader&gt;r1"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-set <span class="org-string">"1"</span>)))
  (<span class="org-string">"&lt;leader&gt;r2"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-set <span class="org-string">"2"</span>)))
  (<span class="org-string">"&lt;leader&gt;r3"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-set <span class="org-string">"3"</span>)))
  (<span class="org-string">"&lt;leader&gt;r4"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-set <span class="org-string">"4"</span>)))
  (<span class="org-string">"s-1"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-jump <span class="org-string">"1"</span>)))
  (<span class="org-string">"s-2"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-jump <span class="org-string">"2"</span>)))
  (<span class="org-string">"s-3"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-jump <span class="org-string">"3"</span>)))
  (<span class="org-string">"s-4"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (bookmark-jump <span class="org-string">"4"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2f017ba" class="outline-3">
<h3 id="org2f017ba">Enlarge window</h3>
<div class="outline-text-3" id="text-org2f017ba">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;wo"</span> . 'doom/window-enlargen)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">doom/window-enlargen</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Enlargen the current window to focus on this one. Does not close other</span>
<span class="org-doc">windows (unlike `</span><span class="org-doc"><span class="org-constant">doom/window-maximize-buffer</span></span><span class="org-doc">'). Activate again to undo."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((param 'doom--enlargen-last-wconf))
      (<span class="org-keyword">cl-destructuring-bind</span> (window . wconf)
          (<span class="org-keyword">or</span> (frame-parameter nil param)
              (cons nil nil))
        (set-frame-parameter
         nil param
         (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (equal window (selected-window))
                  (not arg)
                  wconf)
             (ignore
              (<span class="org-keyword">let</span> ((source-window (selected-window)))
                (set-window-configuration wconf)
                (<span class="org-keyword">when</span> (window-live-p source-window)
                  (select-window source-window))))
           (<span class="org-keyword">prog1</span> (cons (selected-window) (<span class="org-keyword">or</span> wconf (current-window-configuration)))
             (<span class="org-keyword">let*</span> ((window (selected-window))
                    (dedicated-p (window-dedicated-p window))
                    (preserved-p (window-parameter window 'window-preserved-size))
                    (ignore-window-parameters t)
                    (window-resize-pixelwise nil)
                    (frame-resize-pixelwise nil))
               (<span class="org-keyword">unwind-protect</span>
                   (<span class="org-keyword">progn</span>
                     (<span class="org-keyword">when</span> dedicated-p
                       (set-window-dedicated-p window nil))
                     (<span class="org-keyword">when</span> preserved-p
                       (set-window-parameter window 'window-preserved-size nil))
                     (maximize-window window))
                 (set-window-dedicated-p window dedicated-p)
                 (<span class="org-keyword">when</span> preserved-p
                   (set-window-parameter window 'window-preserved-size preserved-p))
                 (add-hook 'doom-switch-window-hook #'doom--enlargened-forget-last-wconf-h)))))))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f52146" class="outline-3">
<h3 id="org8f52146">Web browser in emacs</h3>
<div class="outline-text-3" id="text-org8f52146">
<p>
Note:
</p>
<ul class="org-ul">
<li>Sometimes after browsing the web and returning to a buffer
(e.g. this config) some bindings get erased (e.g. <code>ESC</code> does not
return to normal mode)</li>
<li>Apparently this behavior is only buffer local so to fix it one can
just kill the tabspace, reopen the buffer and they get restored</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;sw"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
                    (tabspaces-switch-or-create-workspace <span class="org-string">"web"</span>)
                    (lc/open-url <span class="org-string">"google.com"</span>)))
  (<span class="org-string">"&lt;leader&gt;su"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (call-interactively 'lc/open-url)))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> lc/xwidget-webkit-last-session-buffer nil)
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/open-url-other-window</span> (url <span class="org-type">&amp;optional</span> new-session)
    (<span class="org-keyword">let</span> ((orig-last-session-buffer (<span class="org-keyword">if</span> (boundp 'xwidget-webkit-last-session-buffer)
                                        xwidget-webkit-last-session-buffer
                                      nil)))
      (<span class="org-keyword">setq</span> xwidget-webkit-last-session-buffer lc/xwidget-webkit-last-session-buffer)
      (<span class="org-keyword">save-window-excursion</span>
        (xwidget-webkit-browse-url url new-session))
      (pop-to-buffer xwidget-webkit-last-session-buffer)
      (<span class="org-keyword">setq</span> lc/xwidget-webkit-last-session-buffer xwidget-webkit-last-session-buffer)
      (<span class="org-keyword">setq</span> xwidget-webkit-last-session-buffer orig-last-session-buffer)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/open-url</span> (url <span class="org-type">&amp;optional</span> other-window new-session)
    (<span class="org-keyword">interactive</span>
     (list
      (read-string  <span class="org-string">"Enter URL or keywords: "</span> nil 'eww-prompt-history <span class="org-string">""</span>)))
    (<span class="org-keyword">if</span> other-window
        (lc/open-url-other-window url new-session)
      (xwidget-webkit-browse-url url new-session))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org03c4e84" class="outline-3">
<h3 id="org03c4e84">Search code on github</h3>
<div class="outline-text-3" id="text-org03c4e84">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;sc"</span> . 'github-code-search)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">github-code-search</span> ()
    <span class="org-doc">"Search code on github for a given language."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> ((language (completing-read
                      <span class="org-string">"Language: "</span>
                      '(<span class="org-string">"Emacs+Lisp"</span> <span class="org-string">"Python"</span>  <span class="org-string">"Clojure"</span> <span class="org-string">"R"</span>)))
           (code
            (<span class="org-keyword">thread-last</span>
              (read-string <span class="org-string">"Code: "</span>) (replace-regexp-in-string <span class="org-string">" "</span> <span class="org-string">"+"</span>)))
           (url (concat <span class="org-string">"https://github.com/search?l="</span> language <span class="org-string">"&amp;type=code&amp;q="</span> code)))
      (<span class="org-keyword">if</span> lc/use-xwidget-browser
          (lc/open-url-other-window url)
        (browse-url url)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca7c2df" class="outline-3">
<h3 id="orgca7c2df">Search on google</h3>
<div class="outline-text-3" id="text-orgca7c2df">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;sg"</span> . 'google-search)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">google-search-str</span> (str)
    (<span class="org-keyword">let*</span> ((keywords (replace-regexp-in-string <span class="org-string">" "</span> <span class="org-string">"+"</span> str))
          (url (concat <span class="org-string">"https://www.google.com/search?q="</span> keywords)))
      (<span class="org-keyword">if</span> lc/use-xwidget-browser
          (lc/open-url-other-window url)
        (browse-url url))))
  (<span class="org-keyword">defun</span> <span class="org-function-name">google-search</span> ()
    <span class="org-doc">"Google search region, if active, or ask for search string."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> (region-active-p)
        (google-search-str
         (buffer-substring-no-properties (region-beginning) (region-end)))
      (google-search-str (read-from-minibuffer <span class="org-string">"Search: "</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c21d40" class="outline-3">
<h3 id="org0c21d40">no-littering</h3>
<div class="outline-text-3" id="text-org0c21d40">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> no-littering
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">recentf</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">no-littering</span>)
  (<span class="org-keyword">setq</span> make-backup-files nil)
  (<span class="org-keyword">setq</span> auto-save-default nil)
  (<span class="org-keyword">setq</span> create-lockfiles nil)
  (add-to-list 'recentf-exclude no-littering-var-directory)
  (add-to-list 'recentf-exclude no-littering-etc-directory))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5bc0a6c" class="outline-3">
<h3 id="org5bc0a6c">Popup management</h3>
<div class="outline-text-3" id="text-org5bc0a6c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> display-buffer-alist
        `((,(<span class="org-keyword">rx</span> bos (<span class="org-keyword">or</span> <span class="org-string">"*Apropos*"</span> <span class="org-string">"*Help*"</span> <span class="org-string">"*helpful"</span> <span class="org-string">"*info*"</span> <span class="org-string">"*Summary*"</span>) (0+ not-newline))
           (display-buffer-reuse-mode-window display-buffer-below-selected)
           (window-height . 0.33)
           (mode apropos-mode help-mode helpful-mode Info-mode Man-mode))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org9693335" class="outline-3">
<h3 id="org9693335">Start server</h3>
<div class="outline-text-3" id="text-org9693335">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">unless</span> (<span class="org-keyword">and</span> (fboundp 'server-running-p) (server-running-p))
    (server-start)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org78c5609" class="outline-3">
<h3 id="org78c5609">add :vc keyword to use-package</h3>
<div class="outline-text-3" id="text-org78c5609">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">unless</span> (package-installed-p 'vc-use-package)
    (package-vc-install <span class="org-string">"https://github.com/slotThe/vc-use-package"</span>))
  (<span class="org-keyword">require</span> '<span class="org-constant">vc-use-package</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org429c64f" class="outline-3">
<h3 id="org429c64f">Set fill-column to 82 characters</h3>
<div class="outline-text-3" id="text-org429c64f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq-default</span> fill-column 82)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orga496417" class="outline-3">
<h3 id="orga496417">macro: run-hook-once</h3>
<div class="outline-text-3" id="text-orga496417">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>

  (<span class="org-keyword">defmacro</span> <span class="org-function-name">lc/run-hook-once</span> (hook func <span class="org-type">&amp;rest</span> args)
    <span class="org-doc">"a wrapper to run a func on a hook only once"</span>
    (<span class="org-keyword">let</span> ((func-once (gensym (concat <span class="org-string">"my/"</span> (symbol-name func)
                                     <span class="org-string">"-"</span> <span class="org-string">"at-"</span> (symbol-name hook) <span class="org-string">"-"</span> <span class="org-string">"once"</span>))))
      `(add-hook ',hook
                 (<span class="org-keyword">defun</span> ,func-once ()
                   (funcall #',func)
                   (remove-hook ',hook #',func-once)) <span class="org-warning">,@args)))</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org005cd95" class="outline-3">
<h3 id="org005cd95">load packages incrementally</h3>
<div class="outline-text-3" id="text-org005cd95">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/packages-to-load-incr</span> ()
    <span class="org-doc">"packages to be loaded incrementally after startup"</span>)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/load-incr-timer</span> 2
    <span class="org-doc">"time to load packages incrementally for the first time"</span>)
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">lc/load-incr-idle-time</span> 0.75
    <span class="org-doc">"idle time to load packages incrementally"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/load-packages-incrementally</span> (pkgs)
    <span class="org-doc">"load package from PKGS incrementally"</span>
    (<span class="org-keyword">let</span> ((gc-cons-threshold most-positive-fixnum)
          (pkg (car pkgs))
          (rest-pkgs (cdr pkgs)))
      (<span class="org-keyword">when</span> pkgs
        (<span class="org-keyword">if</span> (<span class="org-keyword">featurep</span> <span class="org-constant">pkg</span>)
            (lc/load-packages-incrementally rest-pkgs)
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">require</span> <span class="org-constant">pkg</span>)
            (run-with-idle-timer
             lc/load-incr-idle-time nil
             #'lc/load-packages-incrementally rest-pkgs))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/load-packages-incrementally-setup</span> ()
    <span class="org-doc">"Set up a idle timer to start idly load packages."</span>
    (run-with-idle-timer
     lc/load-incr-timer nil
     #'lc/load-packages-incrementally lc/packages-to-load-incr))

  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa829a5" class="outline-3">
<h3 id="orgfa829a5">enable winner mode</h3>
<div class="outline-text-3" id="text-orgfa829a5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (winner-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2eb95ce" class="outline-3">
<h3 id="org2eb95ce">auto pair parentheses</h3>
<div class="outline-text-3" id="text-org2eb95ce">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (electric-pair-mode 1)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org96f4060" class="outline-3">
<h3 id="org96f4060">completion buffer</h3>
<div class="outline-text-3" id="text-org96f4060">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> tab-always-indent 'complete)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">hide completions buffer after completion</span>
  (<span class="org-keyword">setq</span> completion-auto-help t)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">switch to completions buffer on second tab</span>
  (<span class="org-keyword">setq</span> completion-auto-select 'second-tab)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">show one column in completions buffer</span>
  (<span class="org-keyword">setq</span> completions-format 'one-column)
  (<span class="org-keyword">setq</span> completions-max-height 20)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Up/down when completing in the minibuffer</span>
  (define-key minibuffer-local-map (kbd <span class="org-string">"C-k"</span>) #'minibuffer-previous-completion)
  (define-key minibuffer-local-map (kbd <span class="org-string">"C-j"</span>) #'minibuffer-next-completion)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Up/down when competing in a normal buffer</span>
  (define-key completion-in-region-mode-map (kbd <span class="org-string">"C-k"</span>) #'minibuffer-previous-completion)
  (define-key completion-in-region-mode-map (kbd <span class="org-string">"C-j"</span>) #'minibuffer-next-completion)
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/sort-by-alpha-length</span> (elems)
    <span class="org-doc">"Sort ELEMS first alphabetically, then by length."</span>
    (sort elems (<span class="org-keyword">lambda</span> (c1 c2)
                  (<span class="org-keyword">or</span> (string-version-lessp c1 c2)
                      (&lt; (length c1) (length c2))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/sort-by-history</span> (elems)
    <span class="org-doc">"Sort ELEMS by minibuffer history.</span>
<span class="org-doc">Use `</span><span class="org-doc"><span class="org-constant">mct-sort-sort-by-alpha-length</span></span><span class="org-doc">' if no history is available."</span>
    (<span class="org-keyword">if-let</span> ((hist (<span class="org-keyword">and</span> (not (eq minibuffer-history-variable t))
                        (symbol-value minibuffer-history-variable))))
        (minibuffer--sort-by-position hist elems)
      (lc/sort-by-alpha-length elems)))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/completion-category</span> ()
    <span class="org-doc">"Return completion category."</span>
    (<span class="org-keyword">when-let</span> ((window (active-minibuffer-window)))
      (<span class="org-keyword">with-current-buffer</span> (window-buffer window)
        (completion-metadata-get
         (completion-metadata (buffer-substring-no-properties
                               (minibuffer-prompt-end)
                               (max (minibuffer-prompt-end) (point)))
                              minibuffer-completion-table
                              minibuffer-completion-predicate)
         'category))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/sort-multi-category</span> (elems)
    <span class="org-doc">"Sort ELEMS per completion category."</span>
    (<span class="org-keyword">pcase</span> (lc/completion-category)
      ('nil elems) <span class="org-comment-delimiter">; </span><span class="org-comment">no sorting</span>
      ('kill-ring elems)
      ('project-file (lc/sort-by-alpha-length elems))
      (_ (lc/sort-by-history elems))))

  (<span class="org-keyword">setq</span> completions-sort #'lc/sort-multi-category)

  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org525480e" class="outline-2">
<h2 id="org525480e">User interface</h2>
<div class="outline-text-2" id="text-org525480e">
</div>
<div id="outline-container-org89e9123" class="outline-3">
<h3 id="org89e9123">Maximize frame on startup</h3>
<div class="outline-text-3" id="text-org89e9123">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (add-hook 'window-setup-hook 'toggle-frame-maximized t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org65f2072" class="outline-3">
<h3 id="org65f2072">Modus themes</h3>
<div class="outline-text-3" id="text-org65f2072">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:if</span> (not lc/use-lambda-theme)
  <span class="org-builtin">:init</span>
  (require-theme 'modus-themes)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add all your customizations prior to loading the themes</span>
  (<span class="org-keyword">setq</span> modus-themes-italic-constructs t
        modus-themes-org-blocks 'greyscale <span class="org-comment-delimiter">; </span><span class="org-comment">{nil,'greyscale,'rainbow}</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">modus-themes-variable-pitch-ui t</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">modus-themes-mixed-fonts t</span>
        modus-themes-headings (<span class="org-keyword">quote</span> ((1 . (variable-pitch 1.4))
                                      (2 . (variable-pitch 1.25))
                                      (3 . (variable-pitch 1.1))
                                      (t . (monochrome))))
        modus-themes-bold-constructs t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">define some palette overrides</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/override-modus-themes-colors</span> ()
    (<span class="org-keyword">setq</span> modus-themes-operandi-color-overrides
          '((bg-main . <span class="org-string">"#fefcf4"</span>)
            (bg-dim . <span class="org-string">"#faf6ef"</span>)
            (bg-alt . <span class="org-string">"#f7efe5"</span>)
            (bg-hl-line . <span class="org-string">"#f4f0e3"</span>)
            (bg-active . <span class="org-string">"#e8dfd1"</span>)
            (bg-inactive . <span class="org-string">"#f6ece5"</span>)
            (bg-region . <span class="org-string">"#c6bab1"</span>)
            (bg-header . <span class="org-string">"#ede3e0"</span>)
            (bg-tab-bar . <span class="org-string">"#dcd3d3"</span>)
            (bg-tab-active . <span class="org-string">"#fdf6eb"</span>)
            (bg-tab-inactive . <span class="org-string">"#c8bab8"</span>)
            (fg-unfocused .<span class="org-string">"#55556f"</span>)))
    (<span class="org-keyword">setq</span> modus-themes-vivendi-color-overrides
          '((bg-main . <span class="org-string">"#100b17"</span>)
            (bg-dim . <span class="org-string">"#161129"</span>)
            (bg-alt . <span class="org-string">"#181732"</span>)
            (bg-hl-line . <span class="org-string">"#191628"</span>)
            (bg-active . <span class="org-string">"#282e46"</span>)
            (bg-inactive . <span class="org-string">"#1a1e39"</span>)
            (bg-region . <span class="org-string">"#393a53"</span>)
            (bg-header . <span class="org-string">"#202037"</span>)
            (bg-tab-bar . <span class="org-string">"#262b41"</span>)
            (bg-tab-active . <span class="org-string">"#120f18"</span>)
            (bg-tab-inactive . <span class="org-string">"#3a3a5a"</span>)
            (fg-unfocused . <span class="org-string">"#9a9aab"</span>))))

  (lc/override-modus-themes-colors)
  (<span class="org-keyword">setq</span> lc/light-theme 'modus-operandi)
  (<span class="org-keyword">setq</span> lc/dark-theme 'modus-vivendi)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b2fc69" class="outline-3">
<h3 id="org6b2fc69">Font</h3>
<div class="outline-text-3" id="text-org6b2fc69">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">lc/default-font-family</span> <span class="org-string">"fira code"</span> 
    <span class="org-doc">"Default font family"</span>
    <span class="org-builtin">:type</span> 'string
    <span class="org-builtin">:group</span> 'lc)

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">lc/variable-pitch-font-family</span> <span class="org-string">"Sans Serif"</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">"cantarell" ;; </span>
    <span class="org-doc">"Variable pitch font family"</span>
    <span class="org-builtin">:type</span> 'string
    <span class="org-builtin">:group</span> 'lc)

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">lc/laptop-font-size</span> 150
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(if lc/is-windows 100 150)</span>
    <span class="org-doc">"Font size used for laptop"</span>
    <span class="org-builtin">:type</span> 'int
    <span class="org-builtin">:group</span> 'lc)

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">lc/monitor-font-size</span>
    150
    <span class="org-doc">"Font size used for laptop"</span>
    <span class="org-builtin">:type</span> 'int
    <span class="org-builtin">:group</span> 'lc)

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">lc/theme</span> nil
    <span class="org-doc">"Current theme (light or dark)"</span>
    <span class="org-builtin">:type</span> 'symbol
    <span class="org-builtin">:options</span> '(light dark)
    <span class="org-builtin">:group</span> 'lc)

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/get-font-size</span> ()
    <span class="org-doc">"font size is calculated according to the size of the primary screen"</span>
    (<span class="org-keyword">let*</span> (<span class="org-comment-delimiter">;; </span><span class="org-comment">(command "xrandr | awk '/primary/{print sqrt( ($(nf-2)/10)^2 + ($nf/10)^2 )/2.54}'")</span>
           (command <span class="org-string">"osascript -e 'tell application \"finder\" to get bounds of window of desktop' | cut -d',' -f3"</span>)
           (screen-width (string-to-number (shell-command-to-string command))))  <span class="org-comment-delimiter">;;</span><span class="org-comment">&lt;</span>
      (<span class="org-keyword">if</span> (&gt; screen-width 2560) lc/monitor-font-size lc/laptop-font-size))) 
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/set-font-size</span> ()
    (<span class="org-keyword">interactive</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Main typeface</span>
    (set-face-attribute 'default nil <span class="org-builtin">:family</span> lc/default-font-family <span class="org-builtin">:height</span> (lc/get-font-size))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Set the fixed pitch face (monospace)</span>
    (set-face-attribute 'fixed-pitch nil <span class="org-builtin">:family</span> lc/default-font-family)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Set the variable pitch face</span>
    (set-face-attribute 'variable-pitch nil <span class="org-builtin">:family</span> lc/variable-pitch-font-family)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">modeline</span>
    (set-face-attribute 'mode-line nil <span class="org-builtin">:family</span> lc/default-font-family <span class="org-builtin">:height</span> (lc/get-font-size))
    (set-face-attribute 'mode-line-inactive nil <span class="org-builtin">:family</span> lc/default-font-family <span class="org-builtin">:height</span> (lc/get-font-size))
    )
  (add-hook 'after-init-hook #'lc/set-font-size)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org1a942d4" class="outline-3">
<h3 id="org1a942d4">all-the-icons</h3>
<div class="outline-text-3" id="text-org1a942d4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> all-the-icons
  <span class="org-builtin">:config</span>
  (add-to-list 'all-the-icons-extension-icon-alist
               '(<span class="org-string">"eld"</span> all-the-icons-fileicon <span class="org-string">"elisp"</span> <span class="org-builtin">:face</span> all-the-icons-purple))
  (add-to-list 'all-the-icons-extension-icon-alist
               '(<span class="org-string">"edn"</span> all-the-icons-fileicon <span class="org-string">"elisp"</span> <span class="org-builtin">:face</span> all-the-icons-purple))
  (add-to-list 'all-the-icons-extension-icon-alist
               '(<span class="org-string">"lock"</span> all-the-icons-fileicon <span class="org-string">"nix"</span> <span class="org-builtin">:face</span> all-the-icons-blue))
  (add-to-list 'all-the-icons-extension-icon-alist
               '(<span class="org-string">"toml"</span> all-the-icons-alltheicon <span class="org-string">"python"</span> <span class="org-builtin">:face</span> all-the-icons-dblue))
)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga297f4e" class="outline-3">
<h3 id="orga297f4e">nerd-icons-dired</h3>
<div class="outline-text-3" id="text-orga297f4e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> nerd-icons-dired
  <span class="org-builtin">:hook</span> (dired-mode . nerd-icons-dired-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa46bb1" class="outline-3">
<h3 id="orgaa46bb1">nerd-icons-completion</h3>
<div class="outline-text-3" id="text-orgaa46bb1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> nerd-icons-completion
  <span class="org-builtin">:hook</span> (marginalia-mode . nerd-icons-completion-marginalia-setup)
  <span class="org-builtin">:init</span>
  (nerd-icons-completion-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb2207c8" class="outline-3">
<h3 id="orgb2207c8">welcome-dashboard</h3>
<div class="outline-text-3" id="text-orgb2207c8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> welcome-dashboard
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"konrad1977/welcome-dashboard"</span>)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> welcome-dashboard-use-nerd-icons t <span class="org-comment-delimiter">;; </span><span class="org-comment">Use nerd icons instead of all-the-icons</span>
        welcome-dashboard-path-max-length 75
        welcome-dashboard-use-fahrenheit nil <span class="org-comment-delimiter">;; </span><span class="org-comment">show in celcius or fahrenheit.</span>
        welcome-dashboard-min-left-padding 10
        welcome-dashboard-image-file <span class="org-string">"~/.config/emacs/true.png"</span>
        welcome-dashboard-image-width 200
        welcome-dashboard-image-height 169)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard-create-welcome-hook)</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/welcome-dashboard--refresh-screen</span> ()
    <span class="org-doc">"Show the welcome-dashboard screen."</span>
    (<span class="org-keyword">setq</span> welcome-dashboard-recentfiles (seq-take recentf-list 9))
    (<span class="org-keyword">with-current-buffer</span> (get-buffer-create welcome-dashboard-buffer)
      (<span class="org-keyword">let*</span> ((buffer-read-only)
             (image (create-image welcome-dashboard-image-file 'png nil <span class="org-builtin">:width</span> welcome-dashboard-image-width <span class="org-builtin">:height</span> welcome-dashboard-image-height))
             (size (image-size image))
             (width (car size))
             (left-margin (max welcome-dashboard-min-left-padding (floor (/ (- (window-width) width) 2))))
             (packages (format <span class="org-string">"%d"</span> (welcome-dashboard--package-length))))
        (erase-buffer)
        (goto-char (point-min))
        (<span class="org-keyword">let</span> ((inhibit-read-only t))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert "\n")</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard--insert-centered (propertize welcome-dashboard-title 'face 'welcome-dashboard-title-face))</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard--insert-recent-files)</span>
          (<span class="org-keyword">setq</span> cursor-type nil)

          <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert "\n")</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard--insert-todos)</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard--insert-text (make-string 60 ?-))</span>

          (insert <span class="org-string">"\n\n"</span>)
          (insert (make-string left-margin ?\ ))
          (insert-image image)
          (insert <span class="org-string">"\n\n"</span>)
          (welcome-dashboard--insert-centered (propertize (format-time-string <span class="org-string">"%A, %B %d %R"</span>) 'face 'welcome-dashboard-time-face))

          (insert <span class="org-string">"\n"</span>)
          (welcome-dashboard--insert-startup-time)
          (welcome-dashboard--insert-package-info packages)
          (welcome-dashboard--insert-weather-info)

          (switch-to-buffer welcome-dashboard-buffer)
          (read-only-mode +1)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(welcome-dashboard-mode)</span>
          (goto-char (point-min))
          (forward-line 3)))))
  (add-hook 'emacs-startup-hook (<span class="org-keyword">lambda</span> () 
                                  (<span class="org-keyword">require</span> '<span class="org-constant">welcome-dashboard</span>)
                                  (lc/welcome-dashboard--refresh-screen))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2b4683" class="outline-3">
<h3 id="orgc2b4683">Doom modeline</h3>
<div class="outline-text-3" id="text-orgc2b4683">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> doom-modeline
  <span class="org-builtin">:if</span> (not lc/use-lambda-line)
  <span class="org-builtin">:hook</span>
  (after-init . doom-modeline-mode)
  <span class="org-builtin">:custom</span>
  (doom-modeline-buffer-encoding nil)
  (doom-modeline-env-enable-python nil)
  (doom-modeline-height 23)
  (doom-modeline-workspace-name nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(doom-modeline-project-detection 'projectile)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(doom-modeline-buffer-file-name-style 'relative-to-project)</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org75f14d8" class="outline-3">
<h3 id="org75f14d8">highlight todo</h3>
<div class="outline-text-3" id="text-org75f14d8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> hl-todo
  <span class="org-builtin">:hook</span>
  ((prog-mode org-mode) . lc/hl-todo-init)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/hl-todo-init</span> ()
    (<span class="org-keyword">setq-local</span> hl-todo-keyword-faces '((<span class="org-string">"HOLD"</span> . <span class="org-string">"#d0bf8f"</span>)
                                        (<span class="org-string">"MAYBE"</span> . <span class="org-string">"#d0bf8f"</span>)
                                        (<span class="org-string">"TODO"</span> . <span class="org-string">"#cc9393"</span>)
                                        (<span class="org-string">"NEXT"</span> . <span class="org-string">"#dca3a3"</span>)
                                        (<span class="org-string">"THEM"</span> . <span class="org-string">"#dc8cc3"</span>)
                                        (<span class="org-string">"PROG"</span> . <span class="org-string">"#7cb8bb"</span>)
                                        (<span class="org-string">"KILL"</span> . <span class="org-string">"#5f7f5f"</span>)
                                        (<span class="org-string">"DONE"</span> . <span class="org-string">"#afd8af"</span>)
                                        (<span class="org-string">"FIXME"</span> . <span class="org-string">"#cc9393"</span>)))
    (hl-todo-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9a7e923" class="outline-3">
<h3 id="org9a7e923">centered cursor mode</h3>
<div class="outline-text-3" id="text-org9a7e923">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> centered-cursor-mode
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;t="</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (centered-cursor-mode 'toggle))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga320ee7" class="outline-3">
<h3 id="orga320ee7">sideline-flymake</h3>
<div class="outline-text-3" id="text-orga320ee7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> sideline-flymake
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"emacs-sideline/sideline-flymake"</span>)
  <span class="org-builtin">:hook</span> (flymake-mode . sideline-mode)
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq sideline-display-backend-name t)</span>
  (<span class="org-keyword">setq</span> sideline-flymake-display-mode 'line)
  (<span class="org-keyword">setq</span> sideline-backends-right '(sideline-flymake)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(use-package sideline-lsp</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:vc (:fetcher "github" :repo "emacs-sideline/sideline-lsp")</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:hook (lsp-mode . sideline-mode)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:init</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-to-list 'sideline-backends-right 'sideline-lsp)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq sideline-lsp-update-mode 'line)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org75ae4e0" class="outline-3">
<h3 id="org75ae4e0">lambda themes</h3>
<div class="outline-text-3" id="text-org75ae4e0">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> lambda-themes
  <span class="org-builtin">:if</span> (<span class="org-keyword">and</span> lc/use-lambda-theme (display-graphic-p))
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"lambda-emacs/lambda-themes"</span>)
  <span class="org-builtin">:custom</span>
  (lambda-themes-set-italic-comments t)
  (lambda-themes-set-italic-keywords t)
  (lambda-themes-set-variable-pitch t)
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">load preferred theme</span>
  (<span class="org-keyword">setq</span> lc/light-theme 'lambda-light)
  (<span class="org-keyword">setq</span> lc/dark-theme 'lambda-dark))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc76a6f9" class="outline-3">
<h3 id="orgc76a6f9">Load theme and toggle light/dark theme</h3>
<div class="outline-text-3" id="text-orgc76a6f9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;tt"</span> . 'lc/light-dark-theme-toggle)
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">first turn off the deeper-blue theme</span>
  (disable-theme 'deeper-blue)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">poor man's way of checking the hour when emacs is started</span>
  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (&lt; (string-to-number (format-time-string <span class="org-string">"%H"</span>)) <span class="org-comment-delimiter">;; </span><span class="org-comment">&gt;</span>
              19)
           (not (&lt; (string-to-number (format-time-string <span class="org-string">"%H"</span>)) 6 <span class="org-comment-delimiter">;; </span><span class="org-comment">&gt;</span>
                   )))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">light theme</span>
      (load-theme lc/light-theme <span class="org-builtin">:no-confim</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">dark theme</span>
    (load-theme lc/dark-theme <span class="org-builtin">:no-confim</span>))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/light-dark-theme-toggle</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> (eq (car custom-enabled-themes) lc/dark-theme)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">set light-theme</span>
        (<span class="org-keyword">progn</span> (disable-theme lc/dark-theme) (load-theme lc/light-theme <span class="org-builtin">:no-confirm</span>))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">set dark-theme</span>
      (<span class="org-keyword">progn</span> (disable-theme lc/light-theme) (load-theme lc/dark-theme <span class="org-builtin">:no-confirm</span>))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org2a52d97" class="outline-3">
<h3 id="org2a52d97">helpful</h3>
<div class="outline-text-3" id="text-org2a52d97">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> helpful
  <span class="org-builtin">:bind</span>
  (([remap describe-function] . helpful-callable)
   ([remap describe-command]  . helpful-command)
   ([remap describe-variable] . helpful-variable)
   ([remap describe-key]      . helpful-key)
   ([remap describe-symbol]   . helpful-symbol))
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">hotfix, maybe solved?</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">helpful--autoloaded-p</span> (sym buf)
    <span class="org-doc">"Return non-nil if function SYM is autoloaded."</span>
    (<span class="org-keyword">-when-let</span> (file-name (buffer-file-name buf))
      (<span class="org-keyword">setq</span> file-name (s-chop-suffix <span class="org-string">".gz"</span> file-name))
      (<span class="org-keyword">condition-case</span> nil
          (help-fns--autoloaded-p sym file-name)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">new in Emacs 29.0.50</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">see https://github.com/Wilfred/helpful/pull/283</span>
        (<span class="org-warning">error</span> (help-fns--autoloaded-p sym)))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org04d10c3" class="outline-3">
<h3 id="org04d10c3">centaur tabs</h3>
<div class="outline-text-3" id="text-org04d10c3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> centaur-tabs
  <span class="org-builtin">:hook</span>
  (emacs-startup . centaur-tabs-mode)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> centaur-tabs-set-icons t)
  (<span class="org-keyword">setq</span> centaur-tabs-set-modified-marker t
        centaur-tabs-modified-marker <span class="org-string">"M"</span>
        centaur-tabs-cycle-scope 'tabs)
  (<span class="org-keyword">setq</span> centaur-tabs-set-close-button nil)
  (<span class="org-keyword">setq</span> centaur-tabs-enable-ido-completion nil)
  <span class="org-builtin">:config</span>
  (centaur-tabs-mode t)
  (define-key evil-normal-state-map <span class="org-string">"gt"</span> 'centaur-tabs-forward)
  (define-key evil-normal-state-map <span class="org-string">"gT"</span> 'centaur-tabs-backward)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(centaur-tabs-group-by-projectile-project)</span>
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9ca5bf5" class="outline-2">
<h2 id="org9ca5bf5">Evil</h2>
<div class="outline-text-2" id="text-org9ca5bf5">
</div>
<div id="outline-container-org21ecb11" class="outline-3">
<h3 id="org21ecb11">evil mode</h3>
<div class="outline-text-3" id="text-org21ecb11">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil
  <span class="org-builtin">:hook</span>
  (edebug-mode . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">require</span> '<span class="org-constant">evil-collection-edebug</span>) (evil-normalize-keymaps)))
  <span class="org-builtin">:custom</span>
  (evil-want-C-u-scroll t)
  (evil-lookup-func #'helpful-at-point)
  (evil-split-window-below t)
  (evil-vsplit-window-right t)
  (evil-auto-indent nil)
  (evil-want-Y-yank-to-eol t)
  (evil-want-C-i-jump t)
  (evil-undo-system 'undo-redo)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">my/save-excursion-before-indenting</span> (origin-fn <span class="org-type">&amp;rest</span> args)
    (<span class="org-keyword">save-excursion</span> (apply origin-fn args)))
  (<span class="org-keyword">setq</span> evil-want-keybinding nil)
  (evil-mode)
  <span class="org-builtin">:config</span>
  (advice-add #'evil-indent <span class="org-builtin">:around</span> #'my/save-excursion-before-indenting)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">set leader key in normal state</span>
  (evil-set-leader 'normal (kbd <span class="org-string">"SPC"</span>))
  (evil-set-leader 'insert (kbd <span class="org-string">"C-SPC"</span>))
  (evil-set-leader 'visual (kbd <span class="org-string">"SPC"</span>))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">set local leader</span>
  (evil-set-leader 'normal <span class="org-string">","</span> t)
  (evil-set-leader 'insert (kbd <span class="org-string">"C-,"</span>) t)
  (evil-set-leader 'visual <span class="org-string">","</span> t)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">ESC key</span>
  (define-key evil-insert-state-map (kbd <span class="org-string">"ESC"</span>) 'evil-normal-state)
  (define-key evil-insert-state-map (kbd <span class="org-string">"C-g"</span>) 'evil-normal-state)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">set up motion keys</span>
  (define-key evil-motion-state-map <span class="org-string">"_"</span> 'evil-end-of-line)
  (define-key evil-motion-state-map <span class="org-string">"0"</span> 'evil-beginning-of-line)
  (define-key evil-motion-state-map <span class="org-string">"gD"</span> 'xref-find-references)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">unbind C-p so consult can use it</span>
  (define-key evil-normal-state-map (kbd <span class="org-string">"C-p"</span>) nil)
  (define-key evil-insert-state-map (kbd <span class="org-string">"C-p"</span>) nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">unbind C-k so we can use it when completing</span>
  (define-key evil-normal-state-map (kbd <span class="org-string">"C-k"</span>) nil)
  (define-key evil-insert-state-map (kbd <span class="org-string">"C-k"</span>) nil)
  (<span class="org-keyword">with-eval-after-load</span> 'evil-maps
    (define-key evil-motion-state-map (kbd <span class="org-string">"SPC"</span>) nil)
    (define-key evil-motion-state-map (kbd <span class="org-string">"RET"</span>) nil)
    (define-key evil-motion-state-map (kbd <span class="org-string">"TAB"</span>) nil))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org8fc0a9c" class="outline-3">
<h3 id="org8fc0a9c">evil collection</h3>
<div class="outline-text-3" id="text-org8fc0a9c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-collection
  <span class="org-builtin">:after</span> evil
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> evil-collection-mode-list
        '(arc-mode bm bookmark consult comint compile eldoc daemons
                   debug diff-hl diff-mode dired dired-sidebar
                   docker doc-view elisp-refs embark eldoc eshell
                   eww elfeed flymake grep help helpful ibuffer
                   imenu macrostep magit-sections magit magic-todos
                   man markdown-mode mu4e notmuch org org-roam
                   osx-dictionary pdf python replace rg ripgrep
                   tab-bar term vertico vterm wdired wgrep which-key
                   xref xwidget))
  (evil-collection-init)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4d57c8" class="outline-3">
<h3 id="orge4d57c8">eval operator</h3>
<div class="outline-text-3" id="text-orge4d57c8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">evil-extra-operator-eval-modes-alist</span>
    '((emacs-lisp-mode eros-eval-region)
      (org-mode eros-eval-region)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(scheme-mode geiser-eval-region)</span>
      (clojure-mode cider-eval-region)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(jupyter-repl-interaction-mode jupyter-eval-line-or-region)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(python-ts-mode jupyter-eval-region)</span>
      (python-ts-mode lc/eval-in-jupyter-repl)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(python-mode python-shell-send-region) ;; when executing in org-src-edit mode</span>
      )
    <span class="org-doc">"Alist used to determine evil-operator-eval's behaviour.</span>
<span class="org-doc">Each element of this alist should be of this form:</span>
<span class="org-doc"> (MAJOR-MODE EVAL-FUNC [ARGS...])</span>
<span class="org-doc">MAJOR-MODE denotes the major mode of buffer. EVAL-FUNC should be a function</span>
<span class="org-doc">with at least 2 arguments: the region beginning and the region end. ARGS will</span>
<span class="org-doc">be passed to EVAL-FUNC as its rest arguments"</span>
    <span class="org-builtin">:type</span> '(alist <span class="org-builtin">:key-type</span> symbol)
    <span class="org-builtin">:group</span> 'evil-extra-operator)
  (evil-define-operator evil-operator-eval (beg end)
    <span class="org-string">"Evil operator for evaluating code."</span>
    <span class="org-builtin">:move-point</span> nil
    (<span class="org-keyword">interactive</span> <span class="org-string">"&lt;r&gt;"</span>)
    (<span class="org-keyword">let*</span> (<span class="org-comment-delimiter">;; </span><span class="org-comment">(mode (if (and (eq major-mode 'org-mode) (org-in-src-block-p))</span>
           <span class="org-comment-delimiter">;;           </span><span class="org-comment">(intern (car (org-babel-get-src-block-info)))</span>
           <span class="org-comment-delimiter">;;         </span><span class="org-comment">major-mode))</span>
           (mode major-mode)
           (ele (assoc mode evil-extra-operator-eval-modes-alist))
           (f-a (cdr-safe ele))
           (func (car-safe f-a))
           (args (cdr-safe f-a)))
      (<span class="org-keyword">unless</span> (fboundp func)
        (message <span class="org-string">"eval operator function not defined for current major mode"</span>))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(save-mark-and-excursion (apply func beg end args))</span>
      (apply func beg end args)
      (goto-char end)))

  (define-key evil-motion-state-map <span class="org-string">"gr"</span> 'evil-operator-eval)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org03424c1" class="outline-3">
<h3 id="org03424c1">evil-org-mode, org text objects</h3>
<div class="outline-text-3" id="text-org03424c1">
<p>
Text objects:
</p>
<dl class="org-dl">
<dt><code>e</code></dt><dd>code block</dd>
<dt><code>R</code></dt><dd>subtree</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-org-mode
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"hlissner/evil-org-mode"</span>)
  <span class="org-builtin">:bind</span>
  ([remap evil-org-org-insert-heading-respect-content-below] . +org/insert-item-below) <span class="org-comment-delimiter">;; </span><span class="org-comment">"&lt;C-return&gt;"</span>
  ([remap evil-org-org-insert-todo-heading-respect-content-below] . +org/insert-item-above) <span class="org-comment-delimiter">;; </span><span class="org-comment">"&lt;C-S-return&gt;"</span>
  (<span class="org-builtin">:map</span> org-mode-map
        (<span class="org-string">"RET"</span> . 'org-open-at-point))
  <span class="org-builtin">:hook</span>
  (org-mode . lc/init-evil-org-mode)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/init-evil-org-mode</span> ()
    (<span class="org-keyword">require</span> '<span class="org-constant">evil-org</span>)
    (evil-normalize-keymaps)
    (evil-org-set-key-theme '(textobjects))
    (<span class="org-keyword">require</span> '<span class="org-constant">evil-org-agenda</span>)
    (evil-org-agenda-set-keys)
    (evil-org-mode)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">disable annoying insert-new-line-and-indent behavior</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key evil-org-mode-map (kbd "&lt;normal-state&gt;o") nil)</span>
    )
  (<span class="org-keyword">defun</span> <span class="org-function-name">+org--insert-item</span> (direction)
    (<span class="org-keyword">let</span> ((context (org-element-lineage
                    (org-element-context)
                    '(table table-row headline inlinetask item plain-list)
                    t)))
      (<span class="org-keyword">pcase</span> (org-element-type context)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a new list item (carrying over checkboxes if necessary)</span>
        ((<span class="org-keyword">or</span> `item `plain-list)
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Position determines where org-insert-todo-heading and org-insert-item</span>
         <span class="org-comment-delimiter">;; </span><span class="org-comment">insert the new list item.</span>
         (<span class="org-keyword">if</span> (eq direction 'above)
             (org-beginning-of-item)
           (org-end-of-item)
           (backward-char))
         (org-insert-item (org-element-property <span class="org-builtin">:checkbox</span> context))
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Handle edge case where current item is empty and bottom of list is</span>
         <span class="org-comment-delimiter">;; </span><span class="org-comment">flush against a new heading.</span>
         (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (eq direction 'below)
                    (eq (org-element-property <span class="org-builtin">:contents-begin</span> context)
                        (org-element-property <span class="org-builtin">:contents-end</span> context)))
           (org-end-of-item)
           (org-end-of-line)))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a new table row</span>
        ((<span class="org-keyword">or</span> `table `table-row)
         (<span class="org-keyword">pcase</span> direction
           ('below (<span class="org-keyword">save-excursion</span> (org-table-insert-row t))
                   (org-table-next-row))
           ('above (<span class="org-keyword">save-excursion</span> (org-shiftmetadown))
                   (+org/table-previous-row))))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Otherwise, add a new heading, carrying over any todo state, if</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">necessary.</span>
        (_
         (<span class="org-keyword">let</span> ((level (<span class="org-keyword">or</span> (org-current-level) 1)))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">I intentionally avoid `</span><span class="org-comment"><span class="org-constant">org-insert-heading</span></span><span class="org-comment">' and the like because they</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">impose unpredictable whitespace rules depending on the cursor</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">position. It's simpler to express this command's responsibility at a</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">lower level than work around all the quirks in org's API.</span>
           (<span class="org-keyword">pcase</span> direction
             (`below
              (<span class="org-keyword">let</span> (org-insert-heading-respect-content)
                (goto-char (line-end-position))
                (org-end-of-subtree)
                (insert <span class="org-string">"\n"</span> (make-string level ?*) <span class="org-string">" "</span>)))
             (`above
              (org-back-to-heading)
              (insert (make-string level ?*) <span class="org-string">" "</span>)
              (<span class="org-keyword">save-excursion</span> (insert <span class="org-string">"\n"</span>))))
           (<span class="org-keyword">when-let*</span> ((todo-keyword (org-element-property <span class="org-builtin">:todo-keyword</span> context))
                       (todo-type    (org-element-property <span class="org-builtin">:todo-type</span> context)))
             (org-todo
              (<span class="org-keyword">cond</span> ((eq todo-type 'done)
                     <span class="org-comment-delimiter">;; </span><span class="org-comment">Doesn't make sense to create more "DONE" headings</span>
                     (car (+org-get-todo-keywords-for todo-keyword)))
                    (todo-keyword)
                    ('todo)))))))

      (<span class="org-keyword">when</span> (org-invisible-p)
        (org-show-hidden-entry))
      (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (<span class="org-keyword">bound-and-true-p</span> evil-local-mode)
                 (not (evil-emacs-state-p)))
        (evil-insert 1))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">+org/insert-item-below</span> (count)
    <span class="org-doc">"Inserts a new heading, table cell or item below the current one."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
    (<span class="org-keyword">dotimes</span> (_ count) (+org--insert-item 'below)))

  (<span class="org-keyword">defun</span> <span class="org-function-name">+org/insert-item-above</span> (count)
    <span class="org-doc">"Inserts a new heading, table cell or item above the current one."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
    (<span class="org-keyword">dotimes</span> (_ count) (+org--insert-item 'above))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org222271c" class="outline-3">
<h3 id="org222271c">evil-commentary</h3>
<div class="outline-text-3" id="text-org222271c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-commentary
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">with-eval-after-load</span> 'evil
    (evil-commentary-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcb2bfcc" class="outline-3">
<h3 id="orgcb2bfcc">evil surround</h3>
<div class="outline-text-3" id="text-orgcb2bfcc">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-surround
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">with-eval-after-load</span> 'evil
    (global-evil-surround-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org08e04d6" class="outline-3">
<h3 id="org08e04d6">evil goggles</h3>
<div class="outline-text-3" id="text-org08e04d6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-goggles
  <span class="org-builtin">:custom</span>
  (evil-goggles-duration 0.1)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">with-eval-after-load</span> 'evil
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(push '(evil-operator-eval</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">:face evil-goggles-yank-face</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">:switch evil-goggles-enable-yank</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">:advice evil-goggles--generic-async-advice)</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">evil-goggles--commands)</span>
    (evil-goggles-mode)
    (evil-goggles-use-diff-faces))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org6c48f46" class="outline-3">
<h3 id="org6c48f46">evil cleverparens, outer form text object</h3>
<div class="outline-text-3" id="text-org6c48f46">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-cleverparens
  <span class="org-builtin">:after</span> (evil)
  <span class="org-builtin">:hook</span>
  (emacs-lisp-mode . lc/init-cleverparens)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/init-cleverparens</span> ()
    (<span class="org-keyword">require</span> '<span class="org-constant">evil-cleverparens-util</span>)
    (evil-define-text-object evil-cp-a-defun (count <span class="org-type">&amp;optional</span> beg end type)
      <span class="org-string">"An outer text object for a top level sexp (defun)."</span>
      (<span class="org-keyword">if</span> (evil-cp--inside-form-p)
          (<span class="org-keyword">let</span> ((bounds (evil-cp--top-level-bounds)))
            (evil-range (car bounds) (cdr bounds) 'inclusive <span class="org-builtin">:expanded</span> t))
        (<span class="org-warning">error</span> <span class="org-string">"Not inside a sexp."</span>)))

    (evil-define-text-object evil-cp-inner-defun (count <span class="org-type">&amp;optional</span> beg end type)
      <span class="org-string">"An inner text object for a top level sexp (defun)."</span>
      (<span class="org-keyword">if</span> (evil-cp--inside-form-p)
          (<span class="org-keyword">let</span> ((bounds (evil-cp--top-level-bounds)))
            (evil-range (1+ (car bounds)) (1- (cdr bounds)) 'inclusive <span class="org-builtin">:expanded</span> t))
        (<span class="org-warning">error</span> <span class="org-string">"Not inside a sexp."</span>)))

    (define-key evil-outer-text-objects-map <span class="org-string">"f"</span> #'evil-cp-a-defun)
    (define-key evil-inner-text-objects-map <span class="org-string">"f"</span> #'evil-cp-inner-defun)
    ))
</pre>
</div>
</div>
</div>

<div id="outline-container-org14d11c3" class="outline-3">
<h3 id="org14d11c3">evil buffer text object</h3>
<div class="outline-text-3" id="text-org14d11c3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">defgroup</span> <span class="org-type">evil-textobj-entire</span> nil
    <span class="org-doc">"Text object entire buffer for Evil"</span>
    <span class="org-builtin">:prefix</span> <span class="org-string">"evil-textobj-entire-"</span>
    <span class="org-builtin">:group</span> 'evil)

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">evil-textobj-entire-key</span> <span class="org-string">"g"</span>
    <span class="org-doc">"Key for evil-inner-entire"</span>
    <span class="org-builtin">:type</span> 'string
    <span class="org-builtin">:group</span> 'evil-textobj-entire)

  (evil-define-text-object evil-entire-entire-buffer (count <span class="org-type">&amp;optional</span> beg end type)
    <span class="org-string">"Select entire buffer"</span>
    (evil-range (point-min) (point-max)))

  (define-key evil-outer-text-objects-map evil-textobj-entire-key 'evil-entire-entire-buffer)
  (define-key evil-inner-text-objects-map evil-textobj-entire-key 'evil-entire-entire-buffer)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb105f7d" class="outline-3">
<h3 id="orgb105f7d">evil-iedit-state</h3>
<div class="outline-text-3" id="text-orgb105f7d">
<p>
Keybindings:
</p>
<dl class="org-dl">
<dt><code>TAB</code></dt><dd>toggle occurrence</dd>
<dt><code>n</code> / <code>N</code></dt><dd>next/prev occurrence</dd>
<dt><code>F</code></dt><dd>restrict scope to function</dd>
<dt><code>J</code> / <code>K</code></dt><dd>extend scope of match down/up</dd>
<dt><code>V</code></dt><dd>toggle visibility of matches</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-iedit-state
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> github <span class="org-builtin">:repo</span> <span class="org-string">"kassick/evil-iedit-state"</span>)
  <span class="org-builtin">:bind</span>
  ((<span class="org-string">"&lt;leader&gt;se"</span> . 'iedit-mode))
  (<span class="org-builtin">:map</span> iedit-lib-keymap
        (<span class="org-string">"n"</span> . 'iedit-next-occurrence)
        (<span class="org-string">"N"</span> . 'iedit-prev-occurrence))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc0962e4" class="outline-3">
<h3 id="orgc0962e4">evil-snipe</h3>
<div class="outline-text-3" id="text-orgc0962e4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> evil-snipe
  <span class="org-builtin">:hook</span>
  (evil-local-mode . evil-snipe-local-mode)
  <span class="org-builtin">:custom</span>
  (evil-snipe-spillover-scope 'whole-visible)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">evil-snipe--collect-keys</span> (<span class="org-type">&amp;optional</span> count forward-p)
    (<span class="org-keyword">let</span> ((echo-keystrokes 0) <span class="org-comment-delimiter">; </span><span class="org-comment">don't mess with the prompt, Emacs</span>
          (count (<span class="org-keyword">or</span> count 1))
          (i evil-snipe--match-count)
          keys)
      (<span class="org-keyword">unless</span> forward-p
        (<span class="org-keyword">setq</span> count (- count)))
      (<span class="org-keyword">unwind-protect</span>
          (<span class="org-keyword">catch</span> '<span class="org-constant">abort</span>
            (<span class="org-keyword">while</span> (&gt; i 0)
              (<span class="org-keyword">let*</span> ((prompt (format <span class="org-string">"%d&gt;%s"</span> i (mapconcat #'char-to-string keys <span class="org-string">""</span>)))
                     (key (evil-read-key (<span class="org-keyword">if</span> evil-snipe-show-prompt prompt))))
                (<span class="org-keyword">cond</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">TAB adds more characters if `</span><span class="org-comment"><span class="org-constant">evil-snipe-tab-increment</span></span><span class="org-comment">'</span>
                 ((<span class="org-keyword">and</span> evil-snipe-tab-increment (eq key ?\t))  <span class="org-comment-delimiter">;; </span><span class="org-comment">TAB</span>
                  (<span class="org-keyword">cl-incf</span> i))
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Enter starts search with current chars</span>
                 ((memq key '(?\r ?\n))  <span class="org-comment-delimiter">;; </span><span class="org-comment">RET</span>
                  (<span class="org-keyword">throw</span> '<span class="org-constant">abort</span> (<span class="org-keyword">if</span> (= i evil-snipe--match-count) 'repeat keys)))
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Abort</span>
                 ((eq key ?\e)  <span class="org-comment-delimiter">;; </span><span class="org-comment">ESC</span>
                  (evil-snipe--cleanup)
                  (<span class="org-keyword">throw</span> '<span class="org-constant">abort</span> 'abort))
                 (t <span class="org-comment-delimiter">; </span><span class="org-comment">Otherwise, process key</span>
                  (<span class="org-keyword">cond</span> ((eq key ?\d)  <span class="org-comment-delimiter">; </span><span class="org-comment">DEL (backspace) deletes a character</span>
                         (<span class="org-keyword">cl-incf</span> i)
                         (<span class="org-keyword">if</span> (&lt;= (length keys) 1)
                             (<span class="org-keyword">progn</span> (evil-snipe--cleanup)
                                    (<span class="org-keyword">throw</span> '<span class="org-constant">abort</span> 'abort))
                           (nbutlast keys)))
                        (t <span class="org-comment-delimiter">;; </span><span class="org-comment">Otherwise add it</span>
                         (<span class="org-keyword">setq</span> keys (append keys (list key)))
                         (<span class="org-keyword">cl-decf</span> i)))
                  (<span class="org-keyword">when</span> evil-snipe-enable-incremental-highlight
                    (evil-snipe--cleanup)
                    (evil-snipe--highlight-all count keys)
                    (add-hook 'pre-command-hook #'evil-snipe--cleanup))))))
            keys))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org47a94df" class="outline-3">
<h3 id="org47a94df">hydra and windows-hydra</h3>
<div class="outline-text-3" id="text-org47a94df">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> hydra
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;ww"</span> . 'evil-windows-hydra/body)
  <span class="org-builtin">:config</span>
  (defhydra evil-windows-hydra (<span class="org-builtin">:hint</span> nil
                                      <span class="org-comment-delimiter">;; </span><span class="org-comment">:pre (smerge-mode 1)</span>
                                      <span class="org-comment-delimiter">;; </span><span class="org-comment">:post (smerge-auto-leave)</span>
                                      )
    <span class="org-string">"</span>
<span class="org-string"> [_h_] &#8674;&#8672; decrease width [_l_] &#8672;&#8674; increase width</span>
<span class="org-string"> [_j_] decrease height [_k_] increase height</span>
<span class="org-string">&#9474; [_q_] quit"</span>
    (<span class="org-string">"h"</span> evil-window-decrease-width)
    (<span class="org-string">"l"</span> evil-window-increase-width)
    (<span class="org-string">"j"</span> evil-window-decrease-height)
    (<span class="org-string">"k"</span> evil-window-increase-height)
    (<span class="org-string">"q"</span> nil <span class="org-builtin">:color</span> blue)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcae1658" class="outline-3">
<h3 id="orgcae1658">Global keybindings</h3>
<div class="outline-text-3" id="text-orgcae1658">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  (define-key emacs-lisp-mode-map (kbd <span class="org-string">"&lt;normal-state&gt; gr"</span>) nil)
  (define-key global-map (kbd <span class="org-string">"&lt;normal-state&gt; gt"</span>) nil)
  (define-key global-map (kbd <span class="org-string">"&lt;normal-state&gt; gT"</span>) nil)
  (define-key global-map (kbd <span class="org-string">"C-j"</span>) nil)
  (define-key global-map (kbd <span class="org-string">"C-k"</span>) nil)
  )

(<span class="org-keyword">use-package</span> evil
  <span class="org-builtin">:config</span>
  (evil-define-key 'normal 'global
    (kbd <span class="org-string">"&lt;leader&gt;SPC"</span>) 'execute-extended-command
    (kbd <span class="org-string">"&lt;leader&gt;R"</span>) 'restart-emacs
    (kbd <span class="org-string">"&lt;leader&gt;;"</span>) 'eval-expression
    <span class="org-comment-delimiter">;; </span><span class="org-comment">previous buffer</span>
    (kbd <span class="org-string">"&lt;leader&gt;`"</span>) '(lambda () (<span class="org-keyword">interactive</span>) (switch-to-buffer (other-buffer (current-buffer) 1)))
    (kbd <span class="org-string">"&lt;leader&gt;bd"</span>)  'kill-current-buffer
    (kbd <span class="org-string">"&lt;leader&gt;br"</span>)  'revert-buffer
    <span class="org-comment-delimiter">;; </span><span class="org-comment">delete file</span>
    (kbd <span class="org-string">"&lt;leader&gt;fD"</span>)  '(lambda () (<span class="org-keyword">interactive</span>) (delete-file (buffer-file-name)))
    (kbd <span class="org-string">"&lt;leader&gt;ff"</span>)  'find-file
    (kbd <span class="org-string">"&lt;leader&gt;fR"</span>)  'rename-visited-file
    (kbd <span class="org-string">"&lt;leader&gt;fs"</span>)  'save-buffer
    (kbd <span class="org-string">"&lt;leader&gt;he"</span>)  'view-echo-area-messages
    (kbd <span class="org-string">"&lt;leader&gt;hl"</span>)  'view-lossage
    (kbd <span class="org-string">"&lt;leader&gt;hL"</span>)  'find-library
    (kbd <span class="org-string">"&lt;leader&gt;hp"</span>)  'describe-package
    (kbd <span class="org-string">"&lt;leader&gt;hv"</span>)  'describe-variable
    (kbd <span class="org-string">"&lt;leader&gt;hf"</span>)  'describe-function
    (kbd <span class="org-string">"&lt;leader&gt;hk"</span>)  'describe-key
    (kbd <span class="org-string">"&lt;leader&gt;hK"</span>)  'describe-keymap
    <span class="org-comment-delimiter">;; </span><span class="org-comment">lisp</span>
    (kbd <span class="org-string">"&lt;leader&gt;lr"</span>)  'raise-sexp
    (kbd <span class="org-string">"&lt;leader&gt;lb"</span>)  'sp-forward-barf-sexp
    (kbd <span class="org-string">"&lt;leader&gt;ls"</span>)  'sp-forward-slurp-sexp
    (kbd <span class="org-string">"&lt;leader&gt;td"</span>)  'toggle-debug-on-error
    (kbd <span class="org-string">"&lt;leader&gt;tf"</span>)  'auto-fill-mode
    (kbd <span class="org-string">"&lt;leader&gt;tl"</span>)  'display-line-numbers-mode
    <span class="org-comment-delimiter">;; </span><span class="org-comment">toggle wrapped lines</span>
    (kbd <span class="org-string">"&lt;leader&gt;tw"</span>)  '(lambda () (<span class="org-keyword">interactive</span>) (toggle-truncate-lines))
    (kbd <span class="org-string">"&lt;leader&gt;tm"</span>)  'toggle-frame-maximized
    (kbd <span class="org-string">"&lt;leader&gt;u"</span>)  'universal-argument
    (kbd <span class="org-string">"&lt;leader&gt;wd"</span>)  'delete-window
    (kbd <span class="org-string">"&lt;leader&gt;wh"</span>)  'windmove-left
    (kbd <span class="org-string">"&lt;leader&gt;wl"</span>)  'windmove-right
    (kbd <span class="org-string">"&lt;leader&gt;wk"</span>)  'windmove-up
    (kbd <span class="org-string">"&lt;leader&gt;wj"</span>)  'windmove-down
    (kbd <span class="org-string">"&lt;leader&gt;wm"</span>)  'delete-other-windows
    (kbd <span class="org-string">"&lt;leader&gt;wr"</span>)  'winner-redo
    (kbd <span class="org-string">"&lt;leader&gt;ws"</span>)  'evil-window-split
    (kbd <span class="org-string">"&lt;leader&gt;wu"</span>)  'winner-undo
    (kbd <span class="org-string">"&lt;leader&gt;wv"</span>)  'evil-window-vsplit
    (kbd <span class="org-string">"&lt;leader&gt;w="</span>)  'balance-windows-area)
  (evil-define-key 'insert 'global
    (kbd <span class="org-string">"&lt;leader&gt;SPC"</span>) 'execute-extended-command
    (kbd <span class="org-string">"M-&lt;tab&gt;"</span>) 'complete-symbol)
  (evil-define-key 'visual 'global
    (kbd <span class="org-string">"&lt;leader&gt;SPC"</span>) 'execute-extended-command)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">dired</span>
  (evil-define-key 'normal dired-mode-map
    (kbd <span class="org-string">"SPC"</span>) 'evil-send-leader
    (kbd <span class="org-string">"h"</span>) 'dired-up-directory
    (kbd <span class="org-string">"l"</span>) 'dired-find-file)
  (evil-define-key 'normal help-mode-map
    (kbd <span class="org-string">"SPC"</span>) 'evil-send-leader)
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0bf2784" class="outline-2">
<h2 id="org0bf2784">GPT interface</h2>
<div class="outline-text-2" id="text-org0bf2784">
</div>
<div id="outline-container-orgbbe8433" class="outline-3">
<h3 id="orgbbe8433">Notes</h3>
<div class="outline-text-3" id="text-orgbbe8433">
<p>
Interesting GPT3 ideas:
</p>
<ul class="org-ul">
<li>Generating fake data/dataframe</li>
<li>Writing unit tests for a function</li>
<li>Checking function code for errors / edge cases</li>
<li>Convert between languages (R to python) or libraries (pandas to polars)</li>
<li>Ask itinerary for a road trip</li>
<li>Reply in a code block / tabular form</li>
</ul>

<p>
<a href="https://github.com/f/awesome-chatgpt-prompts">Awesome chatgpt prompts</a>:
</p>
<ul class="org-ul">
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-an-english-translator-and-improver">Act as an English Translator and Improver</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-midjourney-prompt-generator">Act as a prompt generator for DALL-E</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-an-ascii-artist">Act as an ASCII artist</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-statistician">Act as a statistician</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-psychologist">Act as a psychologist</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-scientific-data-visualizer">Act as a scientific data visualizer</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-regex-generator">Act as a Regex Generator</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-diagram-generator">Act as a Diagram Generator</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-song-recommender">Act as a song recommender</a></li>
<li><a href="https://github.com/f/awesome-chatgpt-prompts#act-as-a-wikipedia-page">Act as a Wikipedia page</a></li>
</ul>

<p>
About <code>temperature</code>:
</p>
<blockquote>
<p>
Setting the API temperature to 0, or close to zero (such as 0.1 or
0.2) tends to give better results in most cases.  In cases where you
need Codex to provide different potential results, start at zero and
then increment upwards by .1 until you find suitable variation.
</p>
</blockquote>

<p>
Best practices for prompt engineering: <a href="https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-openai-api">https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-openai-api</a>
</p>

<p>
Summarize text:
</p>
<blockquote>
<p>
Summarize the text below as a bullet point list of the most important points.
</p>

<p>
Text: """
{text input here}
"""
</p>
</blockquote>

<p>
Write function:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">Write a simple python function that</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">1. Ask me for a number in mile</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">2. It converts miles to kilometers</span>

<span class="org-keyword">def</span> <span class="org-function-name">convert_miles_to_km</span>():
</pre>
</div>
</div>
</div>

<div id="outline-container-org4402c30" class="outline-3">
<h3 id="org4402c30">Complete region/buffer with gpt</h3>
<div class="outline-text-3" id="text-org4402c30">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> request
<span class="org-builtin">:commands</span> request)

(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;cb"</span> . 'lc/gpt-complete-buffer-and-insert)
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(:map evil-visual-state-map</span>
<span class="org-comment-delimiter">;;        </span><span class="org-comment">("&lt;leader&gt;cr" . 'lc/gpt-complete-region-and-insert)</span>
<span class="org-comment-delimiter">;;        </span><span class="org-comment">("&lt;leader&gt;cp" . 'lc/gpt-complete-with-prompt-prefix-and-insert))</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> lc/gpt-api-key-getter (<span class="org-keyword">lambda</span> () (auth-source-pick-first-password <span class="org-builtin">:host</span> <span class="org-string">"chat.openai.com"</span>)))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq lc/gpt-model 'gpt-3.5-turbo-0301)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq lc/gpt-model 'gpt-4-0314)</span>
  (<span class="org-keyword">setq</span> lc/gpt-model 'gpt-4-0613)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq lc/gpt-model 'gpt-3.5-turbo-16k)</span>
  (<span class="org-keyword">setq</span> lc/chat-model t)
  (<span class="org-keyword">setq</span> lc/gpt-max-output-tokens 2000)
  (<span class="org-keyword">setq</span> lc/gpt-temperature 0.1)
  (<span class="org-keyword">setq</span> lc/gpt-top-p 0.1)
  (<span class="org-keyword">setq</span> lc/gpt-frequency-penalty 0)
  (<span class="org-keyword">setq</span> lc/gpt-presence-penalty 0)
  (<span class="org-keyword">setq</span> lc/gpt-prompt-prefix-alist
        '((<span class="org-string">"describe"</span> . <span class="org-string">"Describe the following code."</span>)
          (<span class="org-string">"pytest"</span> . <span class="org-string">"Write a unit test for the following function using pytest."</span>)
          (<span class="org-string">"docstring"</span> . <span class="org-string">"Write a docstring for the following function."</span>)
          ))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/gpt-complete-str</span> (api-key prompt-or-messages)
    <span class="org-doc">"Return the prompt answer from OpenAI API."</span>
    (<span class="org-keyword">let*</span> ((result nil)
           (auth-value (format <span class="org-string">"Bearer %s"</span> api-key))
           (url (<span class="org-keyword">if</span> lc/chat-model <span class="org-string">"https://api.openai.com/v1/chat/completions"</span> <span class="org-string">"https://api.openai.com/v1/completions"</span>))
           (prompt-key (<span class="org-keyword">if</span> lc/chat-model <span class="org-string">"messages"</span> <span class="org-string">"prompt"</span>)))
      (request
        url
        <span class="org-builtin">:type</span> <span class="org-string">"POST"</span>
        <span class="org-builtin">:data</span> (json-encode `((,prompt-key . ,prompt-or-messages)
                             (<span class="org-string">"model"</span>  . ,lc/gpt-model)
                             (<span class="org-string">"temperature"</span> . ,lc/gpt-temperature)
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">("max_tokens" . ,lc/gpt-max-output-tokens)</span>
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">("frequency_penalty" . ,lc/gpt-frequency-penalty)</span>
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">("presence_penalty" . ,lc/gpt-presence-penalty)</span>
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">("top_p" . ,lc/gpt-top-p)</span>
                             ))
        <span class="org-builtin">:headers</span> `((<span class="org-string">"Authorization"</span> . ,auth-value) (<span class="org-string">"Content-Type"</span> . <span class="org-string">"application/json"</span>))
        <span class="org-builtin">:sync</span> t
        <span class="org-builtin">:parser</span> 'json-read
        <span class="org-builtin">:success</span> (<span class="org-keyword">cl-function</span>
                  (<span class="org-keyword">lambda</span> (<span class="org-type">&amp;key</span> data <span class="org-type">&amp;allow-other-keys</span>)
                    (<span class="org-keyword">setq</span> result (<span class="org-keyword">if</span> lc/chat-model
                                     (alist-get 'content (alist-get 'message (elt (alist-get 'choices data) 0)))
                                   (alist-get 'text (elt (alist-get 'choices data) 0))))))
        <span class="org-builtin">:error</span> (<span class="org-keyword">cl-function</span> (<span class="org-keyword">lambda</span> (<span class="org-type">&amp;rest</span> args <span class="org-type">&amp;key</span> error-thrown <span class="org-type">&amp;allow-other-keys</span>)
                              (message <span class="org-string">"Got error: %S"</span> error-thrown))))
      result))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/gpt-complete-and-insert</span> (prompt)
    (<span class="org-keyword">let*</span> ((result (lc/gpt-complete-str (funcall lc/gpt-api-key-getter) prompt)))
      (goto-char (point-max))
      (<span class="org-keyword">if</span> result
          (<span class="org-keyword">progn</span> (insert <span class="org-string">"\n"</span> result) (fill-paragraph))
        (message <span class="org-string">"Empty result"</span>))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/gpt-complete-with-prompt-prefix-and-insert</span> (start end)
    (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
    (<span class="org-keyword">let*</span> ((offset 100)
           (action (completing-read
                    <span class="org-string">"Select completion action: "</span>
                    (<span class="org-keyword">lambda</span> (string predicate action)
                      (<span class="org-keyword">if</span> (eq action 'metadata)
                          `(metadata
                            (display-sort-function . ,#'identity)
                            (annotation-function
                             . ,(<span class="org-keyword">lambda</span> (cand)
                                  (concat (propertize <span class="org-string">" "</span> 'display `((space <span class="org-builtin">:align-to</span> (- right ,offset))))
                                          (cdr (assoc cand lc/gpt-prompt-prefix-alist))))))
                        (complete-with-action action lc/gpt-prompt-prefix-alist string predicate)))
                    nil t))
           (instruction (cdr (assoc action lc/gpt-prompt-prefix-alist)))
           (text (string-trim (buffer-substring start end)))
           (prompt (concat instruction <span class="org-string">"\n"</span> text))
           (messages `[((<span class="org-string">"role"</span>    . <span class="org-string">"user"</span>) (<span class="org-string">"content"</span> . ,prompt))]))
      (lc/gpt-complete-and-insert (<span class="org-keyword">if</span> lc/chat-model messages prompt))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/gpt-complete-region-and-insert</span> (start end)
    <span class="org-doc">"Send the region to OpenAI and insert the result to the end of buffer. "</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
    (<span class="org-keyword">let*</span> ((prompt (buffer-substring-no-properties start end))
           (messages `[((<span class="org-string">"role"</span>    . <span class="org-string">"user"</span>) (<span class="org-string">"content"</span> . ,prompt))]))
      (lc/gpt-complete-and-insert (<span class="org-keyword">if</span> lc/chat-model messages prompt))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/gpt-complete-buffer-and-insert</span> ()
    <span class="org-doc">"Send the ENTIRE buffer, up to max tokens, to OpenAI and insert the result to the end of buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((prompt (buffer-substring-no-properties (point-min) (point-max))))
      (lc/gpt-complete-and-insert prompt)))

  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">request</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org42d49d0" class="outline-3">
<h3 id="org42d49d0">chatgpt-shell</h3>
<div class="outline-text-3" id="text-org42d49d0">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> chatgpt-shell
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:vc (:fetcher "github" :repo "xenodium/chatgpt-shell")</span>
  <span class="org-builtin">:load-path</span> <span class="org-string">"~/git/chatgpt-shell"</span>
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"s-g"</span> . 'chatgpt-shell)
  (<span class="org-string">"s-d"</span> . 'dall-e-shell)
  (<span class="org-string">"&lt;leader&gt;op"</span> . lc/open-prompts-file)
  <span class="org-builtin">:custom</span>
  (chatgpt-shell-chatgpt-streaming t)
  (chatgpt-shell-chatgpt-model-version lc/gpt-model)
  (chatgpt-shell-openai-key (<span class="org-keyword">lambda</span> () (auth-source-pick-first-password <span class="org-builtin">:host</span> <span class="org-string">"chat.openai.com"</span>)))
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/open-prompts-file</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">unless</span> (member '(chatgpt-shell . t) org-babel-load-languages)
      (<span class="org-keyword">require</span> '<span class="org-constant">ob-chatgpt-shell</span>)
      (<span class="org-keyword">require</span> '<span class="org-constant">ob-dall-e-shell</span>)
      (ob-dall-e-shell-setup)
      (ob-chatgpt-shell-setup))
    (find-file-other-window lc/gpt-prompts-file)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfb36386" class="outline-3">
<h3 id="orgfb36386">copilot</h3>
<div class="outline-text-3" id="text-orgfb36386">
<p>
NOTE:
</p>
<ul class="org-ul">
<li><a href="https://github.com/jimeh/.emacs.d/blob/master/modules/completion/siren-copilot.el">Reference</a></li>
<li><a href="https://github.com/zerolfx/copilot.el/issues/103">Keybindings</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> copilot
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"zerolfx/copilot.el"</span>)
  <span class="org-builtin">:hook</span>
  (prog-mode . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">when</span> lc/copilot-enabled (copilot-mode))))
  <span class="org-builtin">:custom</span>
  (copilot-idle-delay 0)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;cc"</span> . 'lc/toggle-copilot-mode)
  (<span class="org-builtin">:map</span> copilot-completion-map
        (<span class="org-string">"&lt;right&gt;"</span> . 'copilot-accept-completion)
        (<span class="org-string">"S-TAB"</span> . 'copilot-accept-completion-by-word)
        (<span class="org-string">"S-&lt;tab&gt;"</span> . 'copilot-accept-completion-by-word)
        (<span class="org-string">"C-g"</span> . #'copilot-clear-overlay)
        (<span class="org-string">"C-n"</span> . #'copilot-next-completion)
        (<span class="org-string">"C-p"</span> . #'copilot-previous-completion))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/toggle-copilot-mode</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">setq</span> lc/copilot-enabled (not lc/copilot-enabled))
    (message (<span class="org-keyword">if</span> lc/copilot-enabled <span class="org-string">"Enabled copilot-mode"</span> <span class="org-string">"Disabled copilot-mode"</span>))
    (copilot-mode (<span class="org-keyword">if</span> lc/copilot-enabled 1 -1)))
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgea6d0f5" class="outline-2">
<h2 id="orgea6d0f5">Git</h2>
<div class="outline-text-2" id="text-orgea6d0f5">
</div>
<div id="outline-container-orge1b6ede" class="outline-3">
<h3 id="orge1b6ede">Magit</h3>
<div class="outline-text-3" id="text-orge1b6ede">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> magit
  <span class="org-builtin">:bind</span>
  ((<span class="org-string">"&lt;leader&gt;gb"</span> . 'magit-blame)
   (<span class="org-string">"&lt;leader&gt;gg"</span> . 'magit-status)
   (<span class="org-string">"&lt;leader&gt;gG"</span> . 'magit-status-here)
   (<span class="org-string">"&lt;leader&gt;gl"</span> . 'magit-log)
   (<span class="org-builtin">:map</span> magit-status-mode-map
         (<span class="org-string">"SPC"</span> . evil-send-leader)
         (<span class="org-string">"$"</span> . magit-process-buffer)
         (<span class="org-string">"TAB"</span> . 'magit-section-toggle)
         (<span class="org-string">"ESC"</span> . 'transient-quit-one))
   (<span class="org-builtin">:map</span> magit-stash-mode-map
         (<span class="org-string">"TAB"</span> . 'magit-section-toggle)
         (<span class="org-string">"ESC"</span> . 'transient-quit-one))
   (<span class="org-builtin">:map</span> magit-revision-mode-map
         (<span class="org-string">"TAB"</span> . 'magit-section-toggle)
         (<span class="org-string">"ESC"</span> . 'transient-quit-one))
   (<span class="org-builtin">:map</span> magit-process-mode-map
         (<span class="org-string">"SPC"</span> . evil-send-leader)
         (<span class="org-string">"TAB"</span> . 'magit-section-toggle)
         (<span class="org-string">"ESC"</span> . 'transient-quit-one))
   (<span class="org-builtin">:map</span> magit-diff-mode-map
         (<span class="org-string">"TAB"</span> . 'magit-section-toggle)
         (<span class="org-string">"ESC"</span> . 'transient-quit-one))
   (<span class="org-builtin">:map</span> magit-mode-map
         (<span class="org-string">"&lt;normal-state&gt; zz"</span> . 'evil-scroll-line-to-center)
         (<span class="org-string">"&lt;visual-state&gt; zz"</span> . 'evil-scroll-line-to-center))
   )
  <span class="org-builtin">:custom</span>
  (magit-display-buffer-function #'magit-display-buffer-same-window-except-diff-v1)
  (magit-log-arguments '(<span class="org-string">"--graph"</span> <span class="org-string">"--decorate"</span> <span class="org-string">"--color"</span>))
  (git-commit-fill-column 72)
  (magit-diff-refine-hunk t)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> magit-buffer-name-format (concat <span class="org-string">"*"</span> magit-buffer-name-format <span class="org-string">"*"</span>))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">adding autostash suffix to magit-pull</span>
  (transient-append-suffix 'magit-pull <span class="org-string">"-r"</span>
    '(<span class="org-string">"-a"</span> <span class="org-string">"Autostash"</span> <span class="org-string">"--autostash"</span>))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc06b7b4" class="outline-3">
<h3 id="orgc06b7b4">git time machine</h3>
<div class="outline-text-3" id="text-orgc06b7b4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> git-timemachine
  <span class="org-builtin">:hook</span>
  (git-time-machine-mode . evil-normalize-keymaps)
  <span class="org-builtin">:custom</span>
  (git-timemachine-show-minibuffer-details t)
  <span class="org-builtin">:bind</span>
  ((<span class="org-string">"&lt;leader&gt;gt"</span> . 'git-timemachine-toggle)
   (<span class="org-builtin">:map</span> git-timemachine-mode-map
         (<span class="org-string">"C-k"</span> . 'git-timemachine-show-previous-revision)
         (<span class="org-string">"C-j"</span> . 'git-timemachine-show-next-revision)
         (<span class="org-string">"q"</span> . 'git-timemachine-quit))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbae3879" class="outline-3">
<h3 id="orgbae3879">diff highlight</h3>
<div class="outline-text-3" id="text-orgbae3879">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> diff-hl
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;gn"</span> . 'diff-hl-next-hunk)
  (<span class="org-string">"&lt;leader&gt;gp"</span> . 'diff-hl-previous-hunk)
  <span class="org-builtin">:hook</span>
  ((magit-pre-refresh . diff-hl-magit-pre-refresh)
   (magit-post-refresh . diff-hl-magit-post-refresh)
   (prog-mode org-mode))
  <span class="org-builtin">:custom</span>
  (diff-hl-draw-borders nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq diff-hl-global-modes '(not org-mode))</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq diff-hl-fringe-bmp-function 'diff-hl-fringe-bmp-from-type)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq diff-hl-global-modes (not '(image-mode org-mode)))</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org4dc8bc3" class="outline-3">
<h3 id="org4dc8bc3">smerge-hydra</h3>
<div class="outline-text-3" id="text-org4dc8bc3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> hydra
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;gm"</span> . 'smerge-hydra/body)
  <span class="org-builtin">:hook</span>
  (magit-diff-visit-file . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">when</span> smerge-mode (smerge-hydra/body))))
  <span class="org-builtin">:config</span>
  (defhydra smerge-hydra
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable `</span><span class="org-comment"><span class="org-constant">smerge-mode</span></span><span class="org-comment">' when quitting hydra if no merge conflicts remain.</span>
    (<span class="org-builtin">:hint</span> nil <span class="org-builtin">:pre</span> (smerge-mode 1) <span class="org-builtin">:post</span> (smerge-auto-leave))
    <span class="org-string">"</span>
<span class="org-string">                                                    &#9581;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span>
<span class="org-string">  Movement   Keep           Diff              Other &#9474; smerge &#9474;</span>
<span class="org-string">  &#9581;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9583;</span>
<span class="org-string">     ^_g_^       [_b_] base       [_&lt;_] upper/base    [_C_] Combine</span>
<span class="org-string">     ^_C-k_^     [_u_] upper      [_=_] upper/lower   [_r_] resolve</span>
<span class="org-string">     ^_k_ &#8593;^     [_l_] lower      [_&gt;_] base/lower    [_R_] remove</span>
<span class="org-string">     ^_j_ &#8595;^     [_a_] all        [_H_] hightlight</span>
<span class="org-string">     ^_C-j_^     [_RET_] current  [_E_] ediff             &#9581;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;</span>
<span class="org-string">     ^_G_^                                            &#9474; [_q_] quit"</span>
    (<span class="org-string">"g"</span> (<span class="org-keyword">progn</span> (goto-char (point-min)) (smerge-next)))
    (<span class="org-string">"G"</span> (<span class="org-keyword">progn</span> (goto-char (point-max)) (smerge-prev)))
    (<span class="org-string">"C-j"</span> smerge-next)
    (<span class="org-string">"C-k"</span> smerge-prev)
    (<span class="org-string">"j"</span> next-line)
    (<span class="org-string">"k"</span> previous-line)
    (<span class="org-string">"b"</span> smerge-keep-base)
    (<span class="org-string">"u"</span> smerge-keep-upper)
    (<span class="org-string">"l"</span> smerge-keep-lower)
    (<span class="org-string">"a"</span> smerge-keep-all)
    (<span class="org-string">"RET"</span> smerge-keep-current)
    (<span class="org-string">"\C-m"</span> smerge-keep-current)
    (<span class="org-string">"&lt;"</span> smerge-diff-base-upper)
    (<span class="org-string">"="</span> smerge-diff-upper-lower)
    (<span class="org-string">"&gt;"</span> smerge-diff-base-lower)
    (<span class="org-string">"H"</span> smerge-refine)
    (<span class="org-string">"E"</span> smerge-ediff)
    (<span class="org-string">"C"</span> smerge-combine-with-next)
    (<span class="org-string">"r"</span> smerge-resolve)
    (<span class="org-string">"R"</span> smerge-kill-current)
    (<span class="org-string">"q"</span> nil <span class="org-builtin">:color</span> blue)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8a04f10" class="outline-2">
<h2 id="org8a04f10">Org</h2>
<div class="outline-text-2" id="text-org8a04f10">
</div>
<div id="outline-container-org8aad877" class="outline-3">
<h3 id="org8aad877">Org mode</h3>
<div class="outline-text-3" id="text-org8aad877">
<p>
When exporting <code>.org</code> file to HTML, we can add this header:
</p>
<div class="org-src-container">
<pre class="src src-org"><span class="org-org-meta-line">#+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="<a href="https://gongzhitaao.org/orgcss/org.css&quot;/">https://gongzhitaao.org/orgcss/org.css"/</a>&gt;</span>
</pre>
</div>

<p>
We can avoid evaluation of code with:
</p>
<blockquote>
</blockquote>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> org-mode-map
        (<span class="org-string">"&lt;localleader&gt;a"</span> . 'org-archive-subtree)
        (<span class="org-string">"&lt;localleader&gt;i"</span> . 'org-insert-structure-template)
        (<span class="org-string">"&lt;localleader&gt;ll"</span> . 'org-insert-link)
        (<span class="org-string">"&lt;localleader&gt;ls"</span> . 'org-store-link)
        (<span class="org-string">"&lt;localleader&gt;L"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (org-latex-preview)))
        (<span class="org-string">"&lt;localleader&gt;n"</span> . 'org-toggle-narrow-to-subtree)
        (<span class="org-string">"&lt;localleader&gt;p"</span> . 'org-priority)
        (<span class="org-string">"&lt;localleader&gt;r"</span> . 'org-refile)
        (<span class="org-string">"&lt;localleader&gt;t"</span> . 'org-todo)
        (<span class="org-string">"&lt;localleader&gt;x"</span> . 'org-toggle-checkbox)
        (<span class="org-string">"&lt;normal-state&gt;&lt;localleader&gt;el"</span> . 'eros-eval-last-sexp)
        (<span class="org-string">"&lt;visual-state&gt;&lt;localleader&gt;e"</span> . 'eros-eval-last-sexp)
        (<span class="org-string">"&lt;localleader&gt;E"</span> . 'org-export-dispatch)
        (<span class="org-string">"TAB"</span> . nil)
        (<span class="org-string">"C-j"</span> . nil)
        )
  <span class="org-builtin">:custom</span>
  (org-src-preserve-indentation t)
  (org-src-tab-acts-natively t)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-startup-indented t)</span>
  (org-hide-emphasis-markers t)
  (org-catch-invisible-edits 'error)
  (org-link-descriptive nil)
  (org-pretty-entities t)
  (org-ellipsis <span class="org-string">"&#8230;"</span>)
  (org-insert-heading-respect-content t)
  (org-image-actual-width nil)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">+org-cycle-only-current-subtree-h</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Toggle the local fold at the point, and no deeper."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">unless</span> (eq this-command 'org-shifttab)
      (<span class="org-keyword">save-excursion</span>
        (org-beginning-of-line)
        (<span class="org-keyword">let</span> (invisible-p)
          (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (org-at-heading-p)
                     (<span class="org-keyword">or</span> org-cycle-open-archived-trees
                         (not (member org-archive-tag (org-get-tags))))
                     (<span class="org-keyword">or</span> (not arg)
                         (<span class="org-keyword">setq</span> invisible-p (outline-invisible-p (line-end-position)))))
            (<span class="org-keyword">unless</span> invisible-p
              (<span class="org-keyword">setq</span> org-cycle-subtree-status 'subtree))
            (org-cycle-internal-local)
            t)))))
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable auto-pairing of "&lt;" in org-mode &gt;</span>
  (<span class="org-keyword">with-eval-after-load</span> 'elec-pair
    (add-hook 'org-mode-hook (<span class="org-keyword">lambda</span> ()
                               (<span class="org-keyword">setq-local</span> electric-pair-inhibit-predicate
                                           `(<span class="org-keyword">lambda</span> (c)
                                              (<span class="org-keyword">if</span> (char-equal c ?&lt;   <span class="org-comment-delimiter">;; </span><span class="org-comment">&gt;</span>
                                                              ) <span class="org-warning">t (,electric-pair-inhibit-predicate c)))))))</span>
  (plist-put org-format-latex-options <span class="org-builtin">:background</span> <span class="org-string">"Transparent"</span>)
  (plist-put org-format-latex-options <span class="org-builtin">:scale</span> 1.4)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Only fold the current tree, rather than recursively</span>
  (add-hook 'org-tab-first-hook #'+org-cycle-only-current-subtree-h)
  (add-hook 'org-mode-hook #'org-indent-mode)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org0ddf3dd" class="outline-3">
<h3 id="org0ddf3dd">use org-id in links</h3>
<div class="outline-text-3" id="text-org0ddf3dd">
<p>
How to use:
</p>
<ul class="org-ul">
<li><code>org-store-link</code> will add a <code>CUSTOM_ID</code> property to the subheading if not present</li>
<li><code>org-insert-link</code> will pre-populate with the subheading ID</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:preface</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">org-id</span>)
  (<span class="org-keyword">setq</span> org-id-track-globally nil)
  (<span class="org-keyword">setq</span> org-id-link-to-org-use-id 'create-if-interactive-and-no-custom-id)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org002968c" class="outline-3">
<h3 id="org002968c">org agenda and capture</h3>
<div class="outline-text-3" id="text-org002968c">
<p>
NOTE:
</p>
<ul class="org-ul">
<li>"inbox" and "birthdays" file on iCloud</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;oa"</span> . 'org-agenda-list)
  (<span class="org-string">"&lt;leader&gt;oA"</span> . 'org-agenda)
  (<span class="org-string">"&lt;leader&gt;ot"</span> . 'org-todo-list)
  (<span class="org-string">"&lt;leader&gt;oC"</span> . 'org-capture)
  (<span class="org-string">"&lt;leader&gt;on"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (org-agenda nil <span class="org-string">"n"</span>)))
  (<span class="org-string">"&lt;leader&gt;oi"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file (concat lc/beorg-folder <span class="org-string">"inbox.org"</span>))))
  (<span class="org-string">"&lt;leader&gt;ow"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file (concat lc/beorg-folder <span class="org-string">"workflow.org"</span>))))
  <span class="org-builtin">:custom</span>
  (org-todo-keywords (<span class="org-keyword">quote</span> ((sequence <span class="org-string">"TODO(t)"</span> <span class="org-string">"NEXT(n)"</span> <span class="org-string">"|"</span> <span class="org-string">"HOLD(h)"</span> <span class="org-string">"DONE(d!/!)"</span>))))
  (org-directory lc/beorg-folder)
  (org-agenda-custom-commands
   '((<span class="org-string">"n"</span> <span class="org-string">"Next Tasks"</span>
      ((todo <span class="org-string">"NEXT"</span>
             ((org-agenda-overriding-header <span class="org-string">"Next Tasks"</span>)))))
     (<span class="org-string">"w"</span> <span class="org-string">"Work Tasks"</span> tags-todo <span class="org-string">"+work"</span>)))
  (org-capture-templates
   `((<span class="org-string">"i"</span> <span class="org-string">"Inbox"</span> entry
      (file+headline <span class="org-string">"inbox.org"</span> <span class="org-string">"Inbox"</span>)
      ,(concat <span class="org-string">"* %^{Title}\n"</span>
               <span class="org-string">":PROPERTIES:\n"</span>
               <span class="org-string">":CAPTURED: %U\n"</span>
               <span class="org-string">":END:\n\n"</span>
               <span class="org-string">"%i%l"</span>))
     (<span class="org-string">"w"</span> <span class="org-string">"Work"</span> entry
      (file+headline <span class="org-string">"inbox.org"</span> <span class="org-string">"Work"</span>)
      ,(concat <span class="org-string">"* TODO [#A] %^{Title} :@work:\n"</span>
               <span class="org-string">"SCHEDULED: %^t\n"</span>
               <span class="org-string">":PROPERTIES:\n:CAPTURED: %U\n:END:\n\n"</span>
               <span class="org-string">"%i%?"</span>))))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">when</span> (string-equal system-type <span class="org-string">"darwin"</span>)
    (<span class="org-keyword">setq</span> org-agenda-files (mapcar (<span class="org-keyword">lambda</span> (f) (concat lc/beorg-folder f)) '(<span class="org-string">"inbox.org"</span> <span class="org-string">"20230623T103529--birthdays__life.org"</span>))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f157d0" class="outline-3">
<h3 id="org1f157d0">org appear</h3>
<div class="outline-text-3" id="text-org1f157d0">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org-appear
  <span class="org-builtin">:hook</span> org-mode
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> org-appear-autolinks t)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org9464f33" class="outline-3">
<h3 id="org9464f33">org babel</h3>
<div class="outline-text-3" id="text-org9464f33">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> org-mode-map
        (<span class="org-string">"&lt;localleader&gt;."</span> . 'org-edit-special)
        (<span class="org-string">"&lt;localleader&gt;,"</span> . 'org-ctrl-c-ctrl-c)
        (<span class="org-string">"&lt;localleader&gt;-"</span> . 'org-babel-demarcate-block)
        (<span class="org-string">"&lt;localleader&gt;z"</span> . 'org-babel-hide-result-toggle))
  (<span class="org-builtin">:map</span> org-src-mode-map
        (<span class="org-string">"&lt;localleader&gt;."</span> . 'org-edit-src-exit))
  <span class="org-builtin">:custom</span>
  (org-confirm-babel-evaluate nil)
  (org-src-ask-before-returning-to-edit-buffer nil)
  (org-src-window-setup 'current-window)
  <span class="org-builtin">:config</span>
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((emacs-lisp . t)
     <span class="org-comment-delimiter">;; </span><span class="org-comment">(clojure . t)</span>
     (shell . t)))
  (add-hook 'org-babel-after-execute-hook 'org-display-inline-images 'append)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'org-src-lang-modes '("python" . python-ts))</span>
)

<span class="org-comment-delimiter">;; </span><span class="org-comment">(use-package ob-async</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:hook (org-load . (lambda () (require 'ob-async)))</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:custom</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(ob-async-no-async-languages-alist '("jupyter-python" "jupyter-R" "jupyter-julia")))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org114a50b" class="outline-3">
<h3 id="org114a50b">org modern</h3>
<div class="outline-text-3" id="text-org114a50b">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">add frame borders to show code block "line"</span>
(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(modify-all-frames-parameters</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">'((right-divider-width . 10)</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">(internal-border-width . 10)))</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/hide-divider-and-fringe</span> ()
    (<span class="org-keyword">dolist</span> (face '(window-divider
                    window-divider-first-pixel
                    window-divider-last-pixel))
      (face-spec-reset-face face)
      (set-face-foreground face (face-attribute 'default <span class="org-builtin">:background</span>)))
    (set-face-background 'fringe (face-attribute 'default <span class="org-builtin">:background</span>)))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">call it once at init time</span>
  (lc/hide-divider-and-fringe)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">call it every time the theme changes</span>
  (advice-add 'lc/light-dark-theme-toggle
              <span class="org-builtin">:after</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (lc/hide-divider-and-fringe))))

(<span class="org-keyword">use-package</span> org-modern
  <span class="org-builtin">:custom</span>
  (org-modern-block-fringe 10)
  (org-use-sub-superscripts nil)
  (org-pretty-entities-include-sub-superscripts nil)
  <span class="org-builtin">:hook</span>
  (org-mode . org-modern-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4410f56" class="outline-3">
<h3 id="org4410f56">org fragtog</h3>
<div class="outline-text-3" id="text-org4410f56">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org-fragtog
  <span class="org-builtin">:hook</span> org-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd74388" class="outline-3">
<h3 id="orgbd74388">org-remote-img</h3>
<div class="outline-text-3" id="text-orgbd74388">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org-remoteimg
  <span class="org-builtin">:hook</span>
  (org-mode . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">require</span> '<span class="org-constant">org-remoteimg</span>)))
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"gaoDean/org-remoteimg"</span>)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> org-display-remote-inline-images 'cache)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org36188f7" class="outline-3">
<h3 id="org36188f7">see HTML block at point</h3>
<div class="outline-text-3" id="text-org36188f7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> lc/org-view-html-tmp-dir <span class="org-string">"/tmp/org-html-preview/"</span>)

  (<span class="org-keyword">use-package</span> f)

  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/org-view-html</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((elem (org-element-at-point))
          (temp-file-path (concat lc/org-view-html-tmp-dir (number-to-string (random (expt 2 32))) <span class="org-string">".html"</span>)))
      (<span class="org-keyword">cond</span>
       ((not (eq 'export-block (car elem)))
        (message <span class="org-string">"Not in an export block!"</span>))
       ((not (string-equal (plist-get (car (cdr elem)) <span class="org-builtin">:type</span>) <span class="org-string">"HTML"</span>))
        (message <span class="org-string">"Export block is not HTML!"</span>))
       (t (<span class="org-keyword">progn</span>
            (f-mkdir lc/org-view-html-tmp-dir)
            (f-write (plist-get (car (cdr elem)) <span class="org-builtin">:value</span>) 'utf-8 temp-file-path)
            (start-process <span class="org-string">"org-html-preview"</span> nil <span class="org-string">"xdg-open"</span> temp-file-path))))))
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc0c7d0c" class="outline-2">
<h2 id="orgc0c7d0c">Minibuffer</h2>
<div class="outline-text-2" id="text-orgc0c7d0c">
</div>
<div id="outline-container-org360b52d" class="outline-3">
<h3 id="org360b52d">cape</h3>
<div class="outline-text-3" id="text-org360b52d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> cape
  <span class="org-builtin">:init</span>
  (add-to-list 'completion-at-point-functions #'cape-file)
  (add-to-list 'completion-at-point-functions #'cape-dabbrev)
  (advice-add 'pcomplete-completions-at-point <span class="org-builtin">:around</span> #'cape-wrap-silent)
  (advice-add 'pcomplete-completions-at-point <span class="org-builtin">:around</span> #'cape-wrap-purify)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org9515525" class="outline-3">
<h3 id="org9515525">consult</h3>
<div class="outline-text-3" id="text-org9515525">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> consult
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;bb"</span> . 'consult-buffer)
  (<span class="org-string">"&lt;leader&gt;fr"</span> . 'consult-recent-file)
  (<span class="org-string">"&lt;leader&gt;rr"</span> . 'consult-bookmark)
  (<span class="org-string">"&lt;leader&gt;so"</span> . 'consult-outline)
  (<span class="org-string">"&lt;leader&gt;ss"</span> . 'consult-line)
  (<span class="org-string">"&lt;leader&gt;sS"</span> . 'lc/search-symbol-at-point)
  (<span class="org-string">"&lt;leader&gt;sp"</span> . 'consult-ripgrep)
  (<span class="org-string">"&lt;leader&gt;sd"</span> . 'lc/consult-ripgrep-at-point)
  (<span class="org-string">"C-p"</span> . 'consult-yank-pop)
  (<span class="org-string">"&lt;insert-state&gt;C-p"</span> . 'consult-yank-pop)
  (<span class="org-string">"M-p"</span> . 'consult-toggle-preview)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/search-symbol-at-point</span> ()
    <span class="org-doc">"Performs a search in the current buffer for thing at point."</span>
    (<span class="org-keyword">interactive</span>)
    (consult-line (thing-at-point 'symbol)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/consult-ripgrep-at-point</span> (<span class="org-type">&amp;optional</span> dir initial)
    (<span class="org-keyword">interactive</span>
     (list
      (read-directory-name <span class="org-string">"Directory:"</span>)
      (<span class="org-keyword">when-let</span> ((s (symbol-at-point)))
        (symbol-name s))))
    (consult-ripgrep dir initial))
  <span class="org-builtin">:config</span>
  (consult-customize
   consult-ripgrep consult-git-grep consult-grep
   consult-bookmark consult-recent-file consult-xref
   consult--source-bookmark consult--source-file-register
   consult--source-recent-file consult--source-project-recent-file
   <span class="org-comment-delimiter">;; </span><span class="org-comment">my/command-wrapping-consult    ;; disable auto previews inside my command</span>
   <span class="org-builtin">:preview-key</span> '(<span class="org-builtin">:debounce</span> 1 any) <span class="org-comment-delimiter">;; </span><span class="org-comment">Option 1: Delay preview</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">:preview-key "M-."            ;; Option 2: Manual preview</span>
   ))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e86faa" class="outline-3">
<h3 id="org6e86faa">consult-notes</h3>
<div class="outline-text-3" id="text-org6e86faa">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> consult-notes
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;sn"</span> . 'consult-notes)
  (<span class="org-string">"&lt;leader&gt;sN"</span> . 'consult-notes-search-in-all-notes)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"denote"</span>)
    (consult-notes-denote-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb21a300" class="outline-3">
<h3 id="orgb21a300">embark</h3>
<div class="outline-text-3" id="text-orgb21a300">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> embark
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"C-l"</span> . 'embark-act)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(:keymaps 'embark-file-map</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">;; "o" 'find-file-other-window</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">"x" 'lc/dired-open-externally)</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org3228413" class="outline-3">
<h3 id="org3228413">marginalia</h3>
<div class="outline-text-3" id="text-org3228413">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> marginalia
  <span class="org-builtin">:hook</span> vertico-mode
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org2ab3db5" class="outline-3">
<h3 id="org2ab3db5">orderless</h3>
<div class="outline-text-3" id="text-org2ab3db5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> orderless
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> completion-styles '(orderless basic))
  (<span class="org-keyword">setq</span> completion-category-overrides '((file (styles . (partial-completion)))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org7362d65" class="outline-3">
<h3 id="org7362d65">vertico + savehist</h3>
<div class="outline-text-3" id="text-org7362d65">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> savehist
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:init</span>
  (savehist-mode))

(<span class="org-keyword">use-package</span> vertico
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> vertico-map
        (<span class="org-string">"C-j"</span> . 'vertico-next)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">("C-k" . 'vertico-next)</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">("C-j" . 'vertico-previous)</span>
        (<span class="org-string">"C-k"</span> . 'vertico-previous)
        )
  <span class="org-builtin">:custom</span>
  (vertico-resize t)
  <span class="org-builtin">:init</span>
  (vertico-mode)
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org77402fc" class="outline-2">
<h2 id="org77402fc">Other packages</h2>
<div class="outline-text-2" id="text-org77402fc">
</div>
<div id="outline-container-org0af3f9f" class="outline-3">
<h3 id="org0af3f9f">denote</h3>
<div class="outline-text-3" id="text-org0af3f9f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> denote
  <span class="org-builtin">:hook</span>
  (dired-mode . denote-dired-mode)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;nk"</span> . 'denote-keywords-add)
  (<span class="org-string">"&lt;leader&gt;nK"</span> . 'denote-keywords-remove)
  (<span class="org-string">"&lt;leader&gt;nr"</span> . 'denote-rename-file)
  (<span class="org-string">"&lt;leader&gt;nl"</span> . 'denote-link)
  (<span class="org-string">"&lt;leader&gt;nb"</span> . 'denote-link-backlinks)
  (<span class="org-string">"&lt;leader&gt;nj"</span> . 'lc/denote-journal)
  <span class="org-builtin">:custom</span>
  (denote-known-keywords '())
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/denote-journal</span> ()
    <span class="org-doc">"Create an entry tagged '</span><span class="org-doc"><span class="org-constant">journal</span></span><span class="org-doc">' with the date as its title."</span>
    (<span class="org-keyword">interactive</span>)
    (denote
     (format-time-string <span class="org-string">"%A %e %B %Y"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">format like Tuesday 14 June 2022</span>
     '(<span class="org-string">"journal"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">multiple keywords are a list of strings: '("one" "two")</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> denote-directory <span class="org-string">"~/OneDrive - The Boston Consulting Group, Inc/Documents/denote"</span>)
  (<span class="org-keyword">setq</span> lc/gpt-prompts-file (concat denote-directory <span class="org-string">"/20230330T145824--useful-gpt-prompts__llm_org.org"</span>))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbb38f8c" class="outline-3">
<h3 id="orgbb38f8c">denote menu</h3>
<div class="outline-text-3" id="text-orgbb38f8c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> denote-menu
  <span class="org-builtin">:commands</span>
  (list-denotes)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;nm"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
                    (tabspaces-switch-or-create-workspace <span class="org-string">"denote"</span>) (list-denotes)))
  (<span class="org-string">"&lt;leader&gt;nf"</span> . 'denote-menu-filter-by-keyword)
  (<span class="org-string">"&lt;leader&gt;nF"</span> . 'denote-menu-clear-filters)
  (<span class="org-string">"&lt;leader&gt;nE"</span> . 'denote-menu-export-to-dired))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6cacbe3" class="outline-3">
<h3 id="org6cacbe3">dired and extensions</h3>
<div class="outline-text-3" id="text-org6cacbe3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> dired
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;fd"</span> . 'dired)
  (<span class="org-string">"&lt;leader&gt;fj"</span> . 'dired-jump)
  <span class="org-builtin">:hook</span>
  (dired-mode . dired-hide-details-mode)
  <span class="org-builtin">:custom</span>
  (dired-listing-switches <span class="org-string">"-lah"</span>)
  (dired-kill-when-opening-new-dired-buffer t)
  (dired-dwim-target t)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/open-in-finder</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((fn (dired-get-file-for-visit)))
      (start-process <span class="org-string">"open-directory"</span> nil <span class="org-string">"open"</span> <span class="org-string">"-R"</span> fn)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/dired-open-externally</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((fn (dired-get-file-for-visit)))
      (start-process <span class="org-string">"open-external"</span> nil <span class="org-string">"open"</span> fn)))
  <span class="org-builtin">:config</span>
  (define-key dired-mode-map (kbd <span class="org-string">"&lt;normal-state&gt;i"</span>) nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable SPC-fjj acting weirdly</span>
  (define-key dired-jump-map (kbd <span class="org-string">"j"</span>) nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable dired-next-line</span>
  (define-key dired-mode-map (kbd <span class="org-string">"SPC"</span>) nil)
  (define-key dired-mode-map (kbd <span class="org-string">"&lt;normal-state&gt; SPC"</span>) nil)
  (define-key dired-mode-map (kbd <span class="org-string">"&lt;normal-state&gt;X"</span>) nil)
  (<span class="org-keyword">with-eval-after-load</span> 'evil-collection
    (evil-collection-define-key 'normal 'dired-mode-map
      <span class="org-string">"X"</span> 'lc/dired-open-externally
      <span class="org-string">"F"</span> 'lc/open-in-finder))
  )

(<span class="org-keyword">use-package</span> dired-hide-dotfiles
  <span class="org-builtin">:hook</span>
  (dired-mode . dired-hide-dotfiles-mode)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">with-eval-after-load</span> 'evil-collection
    (evil-collection-define-key 'normal 'dired-mode-map
      <span class="org-string">"H"</span> 'dired-hide-dotfiles-mode)))

(<span class="org-keyword">use-package</span> dired-subtree
  <span class="org-builtin">:init</span>
  (advice-add 'dired-subtree-toggle
              <span class="org-builtin">:after</span> (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
                       (<span class="org-keyword">when</span> all-the-icons-dired-mode (revert-buffer))))
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">with-eval-after-load</span> 'evil-collection
    (evil-collection-define-key 'normal 'dired-mode-map
      <span class="org-string">"i"</span> 'dired-subtree-toggle)))

</pre>
</div>
</div>
</div>

<div id="outline-container-org3d86b24" class="outline-3">
<h3 id="org3d86b24">eros</h3>
<div class="outline-text-3" id="text-org3d86b24">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> eros
  <span class="org-builtin">:commands</span>
  (eros-eval-region eros-eval-last-sexp)
  <span class="org-builtin">:hook</span>
  (emacs-lisp-mode org-mode lisp-interaction-mode)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">eros-eval-region</span> (start end)
    (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
    (eros--eval-overlay
     (string-trim
      (<span class="org-keyword">with-output-to-string</span>
        (eval-region start end standard-output)))
     (max (point) (mark))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a859ba" class="outline-3">
<h3 id="org4a859ba">jinx</h3>
<div class="outline-text-3" id="text-org4a859ba">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> jinx
  <span class="org-builtin">:hook</span> (org-mode . jinx-mode)
  <span class="org-builtin">:bind</span> ([remap ispell-word] . jinx-correct))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2cc413b" class="outline-3">
<h3 id="org2cc413b">flymake</h3>
<div class="outline-text-3" id="text-org2cc413b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> flymake
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;!j"</span> . 'flymake-goto-next-error)
  (<span class="org-string">"&lt;leader&gt;!k"</span> . 'flymake-goto-prev-error)
  <span class="org-builtin">:hook</span>
  (python-ts-mode emacs-lisp-mode)
  <span class="org-builtin">:custom</span>
  (flymake-fringe-indicator-position 'right-fringe))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9925677" class="outline-3">
<h3 id="org9925677">persistent scratch</h3>
<div class="outline-text-3" id="text-org9925677">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> persistent-scratch
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;bs"</span> . (<span class="org-keyword">lambda</span> ()
                    <span class="org-doc">"Load persistent-scratch if not already loaded"</span>
                    (<span class="org-keyword">interactive</span>)
                    (<span class="org-keyword">progn</span>
                      (<span class="org-keyword">unless</span> (boundp 'persistent-scratch-mode)
                        (<span class="org-keyword">require</span> '<span class="org-constant">persistent-scratch</span>))
                      (pop-to-buffer <span class="org-string">"*scratch*"</span>))))
  <span class="org-builtin">:custom</span>
  (persistent-scratch-autosave-interval 60)
  <span class="org-builtin">:config</span>
  (persistent-scratch-setup-default))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7017d84" class="outline-3">
<h3 id="org7017d84">project</h3>
<div class="outline-text-3" id="text-org7017d84">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> project
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;pf"</span> . 'project-find-file)
  (<span class="org-string">"&lt;leader&gt;pb"</span> . 'project-switch-to-buffer)
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> project-vc-extra-root-markers '(<span class="org-string">"pyproject.toml"</span> <span class="org-string">".project"</span>))
  (<span class="org-keyword">setq</span> project-vc-ignores '(<span class="org-string">".idea"</span> <span class="org-string">".vscode"</span> <span class="org-string">".direnv"</span>))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf032cf1" class="outline-3">
<h3 id="orgf032cf1">Rainbow parentheses</h3>
<div class="outline-text-3" id="text-orgf032cf1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> rainbow-delimiters
  <span class="org-builtin">:hook</span>
  (emacs-lisp-mode clojure-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1c50d0f" class="outline-3">
<h3 id="org1c50d0f">tempel</h3>
<div class="outline-text-3" id="text-org1c50d0f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> tempel
  <span class="org-builtin">:custom</span>
  (tempel-trigger-prefix <span class="org-string">"&lt;"</span>)
  (tempel-path (concat lc/config-directory <span class="org-string">"/templates.eld"</span>))
  <span class="org-builtin">:hook</span>
  ((prog-mode org-mode) . tempel-setup-capf)
  <span class="org-builtin">:preface</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Setup completion at point</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">tempel-setup-capf</span> ()
    (<span class="org-keyword">setq-local</span> completion-at-point-functions
                (cons #'tempel-complete
                      completion-at-point-functions)))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(tempel-key "C-c t f" fun emacs-lisp-mode-map)</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf1c4880" class="outline-3">
<h3 id="orgf1c4880">Transpose frame</h3>
<div class="outline-text-3" id="text-orgf1c4880">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> transpose-frame
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;wt"</span> . 'transpose-frame)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">flip</span>
  (<span class="org-string">"&lt;leader&gt;wf"</span> . 'rotate-frame))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bf5747" class="outline-3">
<h3 id="org6bf5747">tab-bar</h3>
<div class="outline-text-3" id="text-org6bf5747">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> tab-bar
  <span class="org-builtin">:ensure</span> nil
  <span class="org-builtin">:custom</span>
  (tab-bar-show nil)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;TAB h"</span> . 'tab-bar-switch-to-prev-tab)
  (<span class="org-string">"&lt;leader&gt;TAB l"</span> . 'tab-bar-switch-to-next-tab)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf789c83" class="outline-3">
<h3 id="orgf789c83">perspective</h3>
<div class="outline-text-3" id="text-orgf789c83">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> perspective
  <span class="org-builtin">:commands</span> (persp-new persp-switch persp-state-save)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;pp"</span> . 'lc/switch-or-create-project)
  (<span class="org-string">"&lt;leader&gt;TAB m"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (persp-switch <span class="org-string">"main"</span>)))
  (<span class="org-string">"&lt;leader&gt;TAB d"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (persp-kill (persp-current-name))))
  (<span class="org-string">"&lt;leader&gt;o t"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (persp-switch <span class="org-string">"term"</span>) (vterm)))
  (<span class="org-string">"&lt;leader&gt;TAB x"</span> . 'persp-kill-others)
  (<span class="org-string">"&lt;leader&gt;nn"</span> . 'lc/open-denote-or-switch)
  (<span class="org-string">"&lt;leader&gt;oc"</span> . (<span class="org-keyword">lambda</span> ()
                    (<span class="org-keyword">interactive</span>)
                    (project--ensure-read-project-list)
                    (lc/switch-or-create-project <span class="org-string">"~/.config/emacs"</span>)))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(lc/leader-keys</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"&lt;leader&gt;TAB" '(:ignore true :wk "tab")</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB TAB" 'persp-switch</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB `" 'persp-switch-last</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB d" 'persp-kill</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB h" 'persp-prev</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB l" 'persp-next</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB x" '((lambda () (interactive) (persp-kill (persp-current-name))) :wk "kill current")</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB X" '((lambda () (interactive) (persp-kill (persp-names))) :wk "kill all")</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">"TAB m" '(lc/main-tab :wk "main"))</span>
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/switch-or-create-project</span> (<span class="org-type">&amp;optional</span> project)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Select project from completing-read</span>
    (<span class="org-keyword">interactive</span>
     (list (project-prompt-project-dir)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Set vars</span>
    (<span class="org-keyword">let*</span> ((project-switch-commands #'project-find-file)
           (pname (file-name-nondirectory (directory-file-name project))))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">1. if tab exists, switch</span>
      (<span class="org-keyword">if</span> (member pname (persp-names))
          (persp-switch pname)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">2. create new tab and open projeft</span>
        (<span class="org-keyword">progn</span>
          (persp-switch pname)
          (<span class="org-keyword">let</span> ((default-directory project))
            (project-find-file))))
      ))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/open-denote-or-switch</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">cond</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">1. in denote, open note or create</span>
     ((string-equal <span class="org-string">"denote"</span> (persp-current-name)) (call-interactively 'denote-open-or-create))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">2. if tab exists, switch</span>
     ((member <span class="org-string">"denote"</span> (persp-names)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">3. create new tab and open projeft</span>
     (t (<span class="org-keyword">progn</span> (persp-switch <span class="org-string">"denote"</span>) (call-interactively 'denote-open-or-create)))))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> persp-state-default-file (expand-file-name <span class="org-string">".persp"</span> user-emacs-directory))
  (<span class="org-keyword">setq</span> persp-mode-prefix-key (kbd <span class="org-string">"&lt;leader&gt; TAB"</span>))
  (persp-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4acf67a" class="outline-3">
<h3 id="org4acf67a">perspective-tabs</h3>
<div class="outline-text-3" id="text-org4acf67a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> perspective-tabs
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"sourcehut"</span> <span class="org-builtin">:repo</span> <span class="org-string">"woozong/perspective-tabs"</span>)
  <span class="org-builtin">:after</span> (perspective)
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;TAB TAB"</span> . 'perspective-tabs-new)
  <span class="org-builtin">:init</span>
  (perspective-tabs-mode +1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org70fa806" class="outline-3">
<h3 id="org70fa806">treemacs</h3>
<div class="outline-text-3" id="text-org70fa806">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> treemacs
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;tp"</span> . 'treemacs)
  (<span class="org-builtin">:map</span> evil-treemacs-state-map
        (<span class="org-string">"SPC"</span> . evil-send-leader)
        (<span class="org-string">"&lt;leader&gt;SPC"</span> . execute-extended-command)
        (<span class="org-string">"&lt;leader&gt;wl"</span> . windmove-right)
        )
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">use-package</span> treemacs-evil <span class="org-builtin">:demand</span> t)
  (<span class="org-keyword">use-package</span> treemacs-tab-bar
    <span class="org-builtin">:demand</span> t
    <span class="org-builtin">:config</span>
    (treemacs-set-scope-type 'Tabs))
  (treemacs-follow-mode t)
  (treemacs-filewatch-mode t)
  (treemacs-fringe-indicator-mode 'always)
  (<span class="org-keyword">when</span> treemacs-python-executable
    (treemacs-git-commit-diff-mode t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf50c38a" class="outline-3">
<h3 id="orgf50c38a">tree-sitter + treesit-auto</h3>
<div class="outline-text-3" id="text-orgf50c38a">
<p>
To build grammar:
</p>
<ul class="org-ul">
<li><code>git clone https://github.com/tree-sitter/tree-sitter-javascript</code></li>
<li><code>./build.sh python</code></li>
<li><code>cp dist/libtree-sitter-python.dylib ~/git/crafted-emacs/tree-sitter/</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> treesit-auto
  <span class="org-builtin">:commands</span> (global-treesit-auto-mode)
  <span class="org-builtin">:when</span> (<span class="org-keyword">and</span> (member <span class="org-string">"TREE_SITTER"</span> (split-string system-configuration-features))
             (executable-find <span class="org-string">"tree-sitter"</span>))
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">crafted-tree-sitter-load</span> (lang-symbol)
    <span class="org-doc">"Setup tree-sitter for a language.</span>

<span class="org-doc">This must be called in the user's configuration to configure</span>
<span class="org-doc">tree-sitter for LANG-SYMBOL.</span>

<span class="org-doc">Example: `(crafted-tree-sitter-load 'python)'"</span>
    (tree-sitter-require lang-symbol)
    (<span class="org-keyword">let</span> ((mode-hook-name
           (intern (concat (symbol-name lang-symbol) <span class="org-string">"-mode-hook"</span>))))
      (add-hook mode-hook-name #'tree-sitter-mode)))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> treesit-font-lock-level 3)
  (<span class="org-keyword">require</span> '<span class="org-constant">treesit</span>)
  (global-treesit-auto-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org418ee89" class="outline-3">
<h3 id="org418ee89">vterm and vterm-toggle</h3>
<div class="outline-text-3" id="text-org418ee89">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> vterm
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:bind</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(:map vterm-mode-map</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">("&lt;insert-state&gt; M-&lt;left&gt;" . (lambda () (interactive) (vterm-send-key (kbd "M-&lt;left&gt;"))))</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">("&lt;insert-state&gt; M-&lt;right&gt;" . (lambda () (interactive) (vterm-send-key (kbd "M-&lt;right&gt;"))))</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">)</span>
  <span class="org-builtin">:custom</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(vterm-shell (executable-find "fish"))</span>
  (vterm-shell (executable-find <span class="org-string">"zsh"</span>))
  (vterm-max-scrollback 10000)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key vterm-mode-map (kbd "M-&lt;left&gt;") nil)</span>
  )

(<span class="org-keyword">use-package</span> vterm-toggle
  <span class="org-builtin">:bind</span>
  (<span class="org-string">"&lt;leader&gt;pt"</span> . 'vterm-toggle)
  (<span class="org-string">"&lt;leader&gt;'"</span> . 'vterm-toggle)
  <span class="org-builtin">:custom</span>
  (vterm-toggle-scope 'project))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3733cdf" class="outline-3">
<h3 id="org3733cdf">xwidget web browser enhancements</h3>
<div class="outline-text-3" id="text-org3733cdf">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> xwwp-full
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"kchanqvq/xwwp"</span>)
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> xwidget-webkit-mode-map
        (<span class="org-string">"&lt;localleader&gt;b"</span> .  'xwidget-webkit-back)
        (<span class="org-string">"&lt;localleader&gt;j"</span> .  'xwwp-ace-toggle)
        (<span class="org-string">"&lt;localleader&gt;o"</span> .  'xwwp-section)
        (<span class="org-string">"&lt;localleader&gt;h"</span> .  'xwwp-history-show))
  <span class="org-builtin">:custom</span>
  (xwwp-follow-link-completion-system 'default)
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">cl</span>))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org590618a" class="outline-2">
<h2 id="org590618a">Programming languages</h2>
<div class="outline-text-2" id="text-org590618a">
</div>
<div id="outline-container-orgde10610" class="outline-3">
<h3 id="orgde10610">eglot</h3>
<div class="outline-text-3" id="text-orgde10610">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> eglot
  <span class="org-builtin">:commands</span> (eglot eglot-ensure)
  <span class="org-builtin">:hook</span>
  (python-ts-mode . eglot-ensure)
  <span class="org-builtin">:custom</span>
  (eglot-autoshutdown t)
  (eglot-workspace-configuration
   '(<span class="org-builtin">:pyright</span> (<span class="org-builtin">:useLibraryCodeForTypes</span> t <span class="org-builtin">:openFilesOnly</span> <span class="org-builtin">:json-false</span>))
   (read-process-output-max (* 1024 1024))
   (eglot-sync-connect 0))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org91a5122" class="outline-3">
<h3 id="org91a5122">dape</h3>
<div class="outline-text-3" id="text-org91a5122">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> dape
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"svaante/dape"</span>)
  <span class="org-builtin">:demand</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> dape--debug-on '(io info error std-server))
  <span class="org-builtin">:config</span>
  (add-to-list 'dape-configs
               `(api
                 modes (python-ts-mode python-mode)
                 command <span class="org-string">"/Users/cambiaghiluca/git/aa-api/.direnv/python-3.11/bin/python"</span>
                 command-args (<span class="org-string">"-m"</span> <span class="org-string">"debugpy.adapter"</span>)
                 <span class="org-builtin">:type</span> <span class="org-string">"executable"</span>
                 <span class="org-builtin">:request</span> <span class="org-string">"launch"</span>
                 <span class="org-builtin">:cwd</span> dape-cwd-fn
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">:cwd "/Users/cambiaghiluca/aa-api/"</span>
                 <span class="org-builtin">:program</span> dape-find-file-buffer-default
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">:program "/Users/cambiaghiluca/git/aa-api/api/__main__.py"</span>
                 <span class="org-builtin">:args</span> [<span class="org-string">"--debug"</span>]
                 ))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add inline variable hints, this feature is highly experimental</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq dape-inline-variables t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">To remove info buffer on startup</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(remove-hook 'dape-on-start-hooks 'dape-info)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">To remove repl buffer on startup</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(remove-hook 'dape-on-start-hooks 'dape-repl)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">By default dape uses gdb keybinding prefix</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq dape-key-prefix "\C-x\C-a")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use n for next etc. in REPL</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq dape-repl-use-shorthand t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Kill compile buffer on build success</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'dape-compile-compile-hooks 'kill-buffer)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Projectile users</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq dape-cwd-fn 'projectile-project-root)</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org4fecdbc" class="outline-3">
<h3 id="org4fecdbc">Clojure</h3>
<div class="outline-text-3" id="text-org4fecdbc">
</div>
<div id="outline-container-org7442e0e" class="outline-4">
<h4 id="org7442e0e">Clojure mode</h4>
<div class="outline-text-4" id="text-org7442e0e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> clojure-mode
  <span class="org-builtin">:mode</span> <span class="org-string">"\\.clj$"</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> clojure-align-forms-automatically t)
        )
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c434b8" class="outline-4">
<h4 id="org8c434b8">clojure-lsp</h4>
<div class="outline-text-4" id="text-org8c434b8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> clojure-mode
  <span class="org-builtin">:after</span> (lsp-mode)
  <span class="org-builtin">:hook</span>
  ((clojure-mode clojurescript-mode)
   . (<span class="org-keyword">lambda</span> ()
       (<span class="org-keyword">setq-local</span> lsp-enable-indentation nil <span class="org-comment-delimiter">; </span><span class="org-comment">cider indentation</span>
                   lsp-enable-completion-at-point nil <span class="org-comment-delimiter">; </span><span class="org-comment">cider completion</span>
                   )
       (lsp-deferred)))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce827e4" class="outline-4">
<h4 id="orgce827e4">Cider</h4>
<div class="outline-text-4" id="text-orgce827e4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> cider
  <span class="org-builtin">:hook</span> ((cider-repl-mode . evil-normalize-keymaps)
         (cider-mode . (<span class="org-keyword">lambda</span> ()
                         (<span class="org-keyword">setq-local</span> evil-lookup-func #'cider-doc)))
         (cider-mode . eldoc-mode))
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> clojure-mode-map
        (<span class="org-string">"&lt;localleader&gt;c"</span> . 'cider-connect-clj)
        (<span class="org-string">"&lt;localleader&gt;j"</span> . 'cider-jack-in)
        (<span class="org-string">"&lt;localleader&gt;J"</span> . 'cider-jack-in-cljs)
        (<span class="org-string">"&lt;localleader&gt;dd"</span> . 'cider-debug-defun-at-point)
        (<span class="org-string">"&lt;localleader&gt;eb"</span> . 'cider-eval-buffer)
        (<span class="org-string">"&lt;localleader&gt;el"</span> . 'cider-eval-last-sexp)
        (<span class="org-string">"&lt;localleader&gt;eL"</span> . 'cider-pprint-eval-last-sexp-to-comment)
        (<span class="org-string">"&lt;localleader&gt;ed"</span> . 'cider-eval-defun-at-point)
        (<span class="org-string">"&lt;localleader&gt;D"</span> . 'cider-pprint-eval-defun-to-comment)
        (<span class="org-string">"&lt;localleader&gt;h"</span> . 'cider-clojuredocs-web)
        (<span class="org-string">"&lt;visual-state&gt;&lt;localleader&gt;e"</span> . 'cider-eval-region)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">("K" . 'cider-doc)</span>
        )
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> nrepl-hide-special-buffers t)
  (<span class="org-keyword">setq</span> nrepl-sync-request-timeout nil)
  (<span class="org-keyword">setq</span> cider-repl-display-help-banner nil)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeb28790" class="outline-4">
<h4 id="orgeb28790">ob-clojure</h4>
<div class="outline-text-4" id="text-orgeb28790">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> org
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">ob-clojure</span>)
  (<span class="org-keyword">setq</span> org-babel-clojure-backend 'cider)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org2e252ee" class="outline-4">
<h4 id="org2e252ee">aggressive-indent</h4>
<div class="outline-text-4" id="text-org2e252ee">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">keep the file indented</span>
(<span class="org-keyword">use-package</span> aggressive-indent
  <span class="org-builtin">:hook</span> (emacs-lisp-mode))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb01b664" class="outline-3">
<h3 id="orgb01b664">Nix</h3>
<div class="outline-text-3" id="text-orgb01b664">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> nix-mode
<span class="org-builtin">:mode</span> <span class="org-string">"\\.nix\\'"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga1546d5" class="outline-3">
<h3 id="orga1546d5">Python</h3>
<div class="outline-text-3" id="text-orga1546d5">
</div>
<div id="outline-container-orgc3d2856" class="outline-4">
<h4 id="orgc3d2856">black</h4>
<div class="outline-text-4" id="text-orgc3d2856">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> python-black
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> python-ts-mode-map
        (<span class="org-string">"&lt;localleader&gt;="</span> . 'python-black-buffer)
        )
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:hook (python-mode . python-black-on-save-mode-enable-dwim)</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac9af25" class="outline-4">
<h4 id="orgac9af25">csv-mode</h4>
<div class="outline-text-4" id="text-orgac9af25">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> csv-mode
  <span class="org-builtin">:hook</span> (csv-mode . lc/init-csv-mode)
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> csv-mode-map
        (<span class="org-string">"&lt;localleader&gt;a"</span> . 'csv-align-fields)
        (<span class="org-string">"&lt;localleader&gt;A"</span> . 'lc/csv-align-visible)
        (<span class="org-string">"&lt;localleader&gt;i"</span> . 'lc/init-csv-mode)
        (<span class="org-string">"&lt;localleader&gt;u"</span> . 'csv-unalign-fields)
        (<span class="org-string">"&lt;localleader&gt;s"</span> . 'csv-sort-fields)
        (<span class="org-string">"&lt;localleader&gt;;"</span> . 'lc/set-csv-semicolon-separator)
        (<span class="org-string">"&lt;localleader&gt;,"</span> . 'lc/reset-csv-separators)
        (<span class="org-string">"&lt;leader&gt;j"</span> . 'csv-columns-hydra/body)
        )
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/forward-word</span> ()
    (<span class="org-keyword">interactive</span>)
    (forward-symbol)
    (forward-symbol)
    (backward-word))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/csv-align-visible</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Align visible fields"</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (csv-align-fields nil (window-start) (window-end)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/set-csv-semicolon-separator</span> ()
    (<span class="org-keyword">interactive</span>)
    (customize-set-variable 'csv-separators '(<span class="org-string">";"</span>)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/reset-csv-separators</span> ()
    (<span class="org-keyword">interactive</span>)
    (customize-set-variable 'csv-separators lc/default-csv-separators))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/init-csv-mode</span> ()
    (<span class="org-keyword">interactive</span>)
    (lc/set-csv-separators)
    (lc/csv-highlight)
    (call-interactively 'csv-align-fields))
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">cl</span>)
  (<span class="org-keyword">require</span> '<span class="org-constant">color</span>)
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/set-csv-separators</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> ((n-commas (count-matches <span class="org-string">","</span> (point-at-bol) (point-at-eol)))
           (n-semicolons (count-matches <span class="org-string">";"</span> (point-at-bol) (point-at-eol))))
      (<span class="org-keyword">if</span> ( <span class="org-comment-delimiter">; </span><span class="org-comment">&lt;</span>
           &gt; n-commas n-semicolons)
          (customize-set-variable 'csv-separators '(<span class="org-string">","</span> <span class="org-string">"       "</span>))
        (customize-set-variable 'csv-separators '(<span class="org-string">";"</span> <span class="org-string">" "</span>)))))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/csv-highlight</span> ()
    (<span class="org-keyword">interactive</span>)
    (font-lock-mode 1)
    (<span class="org-keyword">let*</span> ((separator (string-to-char (car csv-separators)))
           (n (count-matches (string separator) (point-at-bol) (point-at-eol)))
           (colors (loop for i from 0 to 1.0 by (/ 2.0 n)
                         collect (apply #'color-rgb-to-hex
                                        (color-hsl-to-rgb i 0.3 0.5)))))
      (<span class="org-keyword">cl-loop</span> for i from 2 to n by 2
               for c in colors
               for r = (format <span class="org-string">"^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">%c\n]+%c</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\{</span><span class="org-string"><span class="org-variable-name">%d\\</span></span><span class="org-string">}"</span> separator separator i)
               do (font-lock-add-keywords nil `((,r (1 '(face (<span class="org-builtin">:foreground</span> ,c)))))))))
  (defhydra csv-columns-hydra (<span class="org-builtin">:hint</span> nil)
    <span class="org-string">"</span>
<span class="org-string"> [_k_] &#8674;&#8672; previous column [_j_] &#8672;&#8674; next column</span>
<span class="org-string"> [_o_] &#8674;&#8672; expand window</span>
<span class="org-string">&#9474; [_q_] quit"</span>
    (<span class="org-string">"j"</span> lc/forward-word)
    (<span class="org-string">"k"</span> backward-word)
    (<span class="org-string">"o"</span> doom/window-enlargen)
    (<span class="org-string">"q"</span> nil <span class="org-builtin">:color</span> blue))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org9408fa4" class="outline-4">
<h4 id="org9408fa4">direnv</h4>
<div class="outline-text-4" id="text-org9408fa4">
<p>
Example of <code>.envrc</code> file if we need to use <code>x86</code> python:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span class="org-variable-name">pwd_hash</span>=$(<span class="org-builtin">echo</span> -n $<span class="org-variable-name">PWD</span> | shasum | cut -d <span class="org-string">' '</span> -f 1)
<span class="org-variable-name">direnv_layout_dir</span>=$<span class="org-variable-name">XDG_CACHE_HOME</span>/direnv/layouts/$<span class="org-variable-name">pwd_hash</span>
layout python /usr/local/homebrew/bin/python3.9
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> envrc
  <span class="org-builtin">:commands</span>
  (envrc-propagate-environment)
  <span class="org-builtin">:hook</span>
  (python-ts-mode org-jupyter-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org77f78aa" class="outline-4">
<h4 id="org77f78aa">flymake-ruff</h4>
<div class="outline-text-4" id="text-org77f78aa">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> flymake-ruff
  <span class="org-builtin">:hook</span>
  (python-ts-mode . flymake-ruff-load))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda6e1cf" class="outline-4">
<h4 id="orgda6e1cf">jupyter</h4>
<div class="outline-text-4" id="text-orgda6e1cf">
<p>
<code>zmq</code> installation:
</p>
<ul class="org-ul">
<li>Need to have <code>automake</code>, <code>autoconf</code></li>
<li>In <code>straight/build/zmq/src</code> run <code>autoreconf -i</code></li>
<li>In <code>straight/build/zmq</code> run <code>make</code></li>
</ul>

<p>
<code>emacs-zmq</code> installation:
</p>
<ul class="org-ul">
<li>In <code>straight/build/emacs-zmq</code> run <code>wget https://github.com/nnicandro/emacs-zmq/releases/download/v0.10.10/emacs-zmq-x86_64-apple-darwin17.4.0.tar.gz</code></li>
<li>Then <code>tar -xzf emacs-zmq-x86_64-apple-darwin17.4.0.tar.gz</code></li>
<li>Finally <code>cp emacs-zmq-x86_64-apple-darwin17.4.0/emacs-zmq.so emacs-zmq.dylib</code></li>
</ul>

<p>
Compile by hand:
</p>
<ul class="org-ul">
<li><code>git clone https://github.com/nnicandro/emacs-zmq.git</code></li>
<li><code>cd emacs-zmq &amp;&amp; make</code></li>
<li><code>cp src/.libs/emacs-zmq.dylib ../crafted-emacs/personal/elpa/zmq-0.10.10/</code></li>

<li>In the REPL you can use <code>M-p</code> / <code>M-n</code> to navigate previous prompts</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> jupyter
  <span class="org-builtin">:vc</span> (<span class="org-builtin">:fetcher</span> <span class="org-string">"github"</span> <span class="org-builtin">:repo</span> <span class="org-string">"nnicandro/emacs-jupyter"</span>)
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> python-ts-mode-map
        (<span class="org-string">"&lt;localleader&gt;i"</span> . 'lc/jupyter-inspect-df)
        (<span class="org-string">"&lt;localleader&gt;ee"</span> . 'jupyter-eval-line-or-region)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">("&lt;visual-state&gt;&lt;localleader&gt;e" . 'jupyter-eval-line-or-region)</span>
        (<span class="org-string">"&lt;localleader&gt;ed"</span> . 'jupyter-eval-defun)
        (<span class="org-string">"&lt;localleader&gt;eb"</span> . 'jupyter-eval-buffer)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">("&lt;localleader&gt;eb" . (lambda () (interactive) (lc/jupyter-eval-buffer)))</span>
        (<span class="org-string">"&lt;localleader&gt;er"</span> . 'jupyter-eval-remove-overlays)
        (<span class="org-string">"&lt;localleader&gt;kd"</span> . 'lc/kill-repl-kernel)
        (<span class="org-string">"&lt;localleader&gt;ki"</span> . 'jupyter-org-interrupt-kernel)
        (<span class="org-string">"&lt;localleader&gt;kr"</span> . 'jupyter-repl-restart-kernel)
        (<span class="org-string">"&lt;localleader&gt;j"</span> . 'lc/jupyter-repl)
        )
  (<span class="org-builtin">:map</span> org-mode-map
        (<span class="org-string">"&lt;localleader&gt;="</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (jupyter-org-insert-src-block t nil)))
        (<span class="org-string">"&lt;localleader&gt;m"</span> . 'jupyter-org-merge-blocks)
        (<span class="org-string">"&lt;localleader&gt;+"</span> . 'jupyter-org-insert-src-block)
        (<span class="org-string">"&lt;localleader&gt;?"</span> . 'jupyter-inspect-at-point)
        (<span class="org-string">"&lt;localleader&gt;c"</span> . 'jupyter-org-clear-all-results)
        (<span class="org-string">"&lt;localleader&gt;x"</span> . 'jupyter-org-kill-block-and-results))
  <span class="org-builtin">:hook</span>
  (jupyter-repl-persistent-mode .   (<span class="org-keyword">lambda</span> () (<span class="org-keyword">setq-local</span> evil-lookup-func #'jupyter-inspect-at-point)))
  (jupyter-repl-interaction-mode .   (<span class="org-keyword">lambda</span> () (<span class="org-keyword">setq-local</span> evil-lookup-func #'jupyter-inspect-at-point)))
  (jupyter-repl-persistent-mode . (<span class="org-keyword">lambda</span> ()  <span class="org-comment-delimiter">;; </span><span class="org-comment">we activate org-interaction-mode ourselves</span>
                                    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode) (jupyter-org-interaction-mode))))
  (envrc-mode . (<span class="org-keyword">lambda</span> ()
                  (advice-add 'lc/jupyter-repl <span class="org-builtin">:around</span> #'envrc-propagate-environment)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">(advice-add 'jupyter-repl-restart-kernel :around #'envrc-propagate-environment)</span>
                  ))
  <span class="org-builtin">:custom</span>
  (jupyter-repl-prompt-margin-width 4)
  (jupyter-eval-use-overlays nil)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/jupyter-eval-buffer</span> ()
    <span class="org-doc">"Send the contents of BUFFER using `</span><span class="org-doc"><span class="org-constant">jupyter-current-client</span></span><span class="org-doc">'."</span>
    (<span class="org-keyword">interactive</span>)
    (jupyter-eval-string (jupyter-load-file-code (buffer-file-name))))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/jupyter-repl</span> ()
    <span class="org-doc">"If a buffer is already associated with a jupyter buffer, then pop to it. Otherwise start a jupyter kernel."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (<span class="org-keyword">bound-and-true-p</span> jupyter-current-client) (buffer-live-p (eieio-oref jupyter-current-client 'buffer)))
        (jupyter-repl-pop-to-buffer)
      (call-interactively 'jupyter-repl-associate-buffer)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/kill-repl-kernel</span> ()
    <span class="org-doc">"Kill repl buffer associated with current jupyter kernel"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> jupyter-current-client
        (jupyter-with-repl-buffer jupyter-current-client
          (kill-buffer (current-buffer)))
      (<span class="org-warning">error</span> <span class="org-string">"Buffer not associated with a REPL, see `</span><span class="org-string"><span class="org-constant">jupyter-repl-associate-buffer</span></span><span class="org-string">'"</span>)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/jupyter-toggle-overlays</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> jupyter-eval-use-overlays
        (<span class="org-keyword">setq</span> jupyter-eval-use-overlays nil)
      (<span class="org-keyword">setq</span> jupyter-eval-use-overlays t)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/jupyter-inspect-df</span> (dataframe)
    <span class="org-doc">"Save the df to csv and open the file with csv-mode"</span>
    (<span class="org-keyword">interactive</span> (list (read-from-minibuffer <span class="org-string">"DataFrame: "</span> (evil-find-symbol nil))))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(jupyter-eval (format</span>
    <span class="org-comment-delimiter">;;                </span><span class="org-comment">"%s.reset_index().assign(index='').rename(columns={'</span><span class="org-comment"><span class="org-constant">index</span></span><span class="org-comment">': ''}).to_csv('</span><span class="org-comment"><span class="org-constant">%s</span></span><span class="org-comment">', index=False, sep='</span><span class="org-comment"><span class="org-constant">|</span></span><span class="org-comment">')"</span>
    <span class="org-comment-delimiter">;;                </span><span class="org-comment">dataframe lc/jupyter-temp-dataframe-path))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-table-align)</span>
    (jupyter-eval (format  <span class="org-string">"%s.to_csv('</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">', index=False)"</span> dataframe lc/jupyter-temp-dataframe-path))
    (find-file-other-window lc/jupyter-temp-dataframe-path))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/eval-in-jupyter-repl</span> (start end)
    <span class="org-doc">"Send region to Jupyter REPL and return to original buffer."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">let*</span> ((current-buffer (current-buffer))
           (region (<span class="org-keyword">when</span> (use-region-p)
                     (car (region-bounds))))
           (start (car region))
           (end (cdr region))
           (content (buffer-substring
                     (<span class="org-keyword">or</span> start (line-beginning-position))
                     (<span class="org-keyword">or</span> end (line-end-position)))))
      (jupyter-with-repl-buffer jupyter-current-client
        (goto-char (point-max))
        (insert content)
        (jupyter-repl-ret))))
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO refactor to avoid duplication of dap code</span>
  (<span class="org-keyword">setq</span> lc/jupyter-temp-dataframe-buffer  <span class="org-string">"*inspect-df*"</span>)
  (<span class="org-keyword">setq</span> lc/jupyter-temp-dataframe-path <span class="org-string">"~/tmp-inspect-df.csv"</span>)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(advice-add 'jupyter-command :override #'jupyter-command-venv)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">stop spawning output buffer</span>
  (add-to-list 'display-buffer-alist
               '(<span class="org-string">"\\*jupyter-output\\*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\*jupyter-error\\*"</span>
                 (cons 'display-buffer-no-window
                       '((allow-no-window . t)))))
  (add-to-list
   'display-buffer-alist
   '(<span class="org-string">"^\\*jupyter-repl"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">*</span>
     (display-buffer-below-selected)
     (window-width . 0.33)))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orga491c77" class="outline-4">
<h4 id="orga491c77">Org jupyter mode</h4>
<div class="outline-text-4" id="text-orga491c77">
<p>
NOTE:
</p>
<ul class="org-ul">
<li>To save a figure add <code>:file img/hello.png</code> to header args</li>
<li>Set figure params</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> matplotlib <span class="org-keyword">as</span> mpl
mpl.<span class="org-variable-name">rcParams</span>[<span class="org-string">'figure.dpi'</span>] <span class="org-operator">=</span> 200
mpl.<span class="org-variable-name">rcParams</span>[<span class="org-string">'figure.facecolor'</span>] <span class="org-operator">=</span> <span class="org-string">'1'</span>
</pre>
</div>

<ul class="org-ul">
<li>To avoid df in HTMl, use <code>:display plain</code> in header args</li>
<li>To open HTML block at point use <code>lc/org-view-html</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> emacs
  <span class="org-builtin">:hook</span>
  ((org-jupyter-mode . (<span class="org-keyword">lambda</span> ()
                         <span class="org-comment-delimiter">;; </span><span class="org-comment">otherwise jupyter-associate-buffer will fail</span>
                         (<span class="org-keyword">setq</span> major-mode-remap-alist '())
                         (<span class="org-keyword">setq-local</span> evil-lookup-func #'jupyter-inspect-at-point)
                         <span class="org-comment-delimiter">;; </span><span class="org-comment">disable annoying insert-new-line-and-indent behavior</span>
                         (<span class="org-keyword">setq-local</span> indent-line-function 'lc/no-indent)
                         ))
   <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-jupyter-mode . 'org-redisplay-inline-images)</span>
   (org-mode . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">when</span> (lc/is-jupyter-org-buffer?) (org-jupyter-mode)))))
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> org-jupyter-mode-map
        (<span class="org-string">"&lt;localleader&gt;kd"</span> . 'lc/kill-repl-kernel)
        (<span class="org-string">"&lt;localleader&gt;ki"</span> . 'jupyter-org-interrupt-kernel)
        (<span class="org-string">"&lt;localleader&gt;kr"</span> . 'jupyter-repl-restart-kernel)
        )
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/no-indent</span> () 'noindent)
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/is-jupyter-org-buffer?</span> ()
    (<span class="org-keyword">with-current-buffer</span> (buffer-name)
      (goto-char (point-min))
      (re-search-forward <span class="org-string">"begin_src jupyter-"</span> 10000 t)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/org-cycle-or-py-complete</span> (orig-fun <span class="org-type">&amp;rest</span> args)
    <span class="org-doc">"If in a jupyter-python code block, call py-indent-or-complete, otherwise use org-cycle"</span>
    (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (org-in-src-block-p)
             (eq (intern (org-element-property <span class="org-builtin">:language</span> (org-element-at-point))) 'jupyter-python))
        (lc/py-indent-or-complete)
      (apply orig-fun args)))
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/py-indent-or-complete</span> ()
    (<span class="org-keyword">interactive</span> <span class="org-string">"*"</span>)
    (window-configuration-to-register py--windows-config-register)
    (<span class="org-keyword">cond</span> ((use-region-p)
           (py-indent-region (region-beginning) (region-end)))
          ((<span class="org-keyword">or</span> (bolp)
               (member (char-before) (list 9 10 12 13 32 ?:  <span class="org-comment-delimiter">;; </span><span class="org-comment">{[(</span>
                                           ?\) ?\] ?\}))
               <span class="org-comment-delimiter">;; </span><span class="org-comment">(not (looking-at "[ \t]*$"))</span>
               )
           (py-indent-line))
          ((comint-check-proc (current-buffer))
           (<span class="org-keyword">ignore-errors</span> (completion-at-point)))
          (t
           (completion-at-point))))
  (<span class="org-keyword">define-minor-mode</span> <span class="org-function-name">org-jupyter-mode</span>
    <span class="org-doc">"Minor mode which is active when an org file has the string begin_src jupyter-python</span>
<span class="org-doc">    in the first few hundred rows"</span>
    <span class="org-builtin">:keymap</span> (<span class="org-keyword">let</span> ((map (make-sparse-keymap)))
              map)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org564f3e0" class="outline-4">
<h4 id="org564f3e0">scimax-jupyter</h4>
<div class="outline-text-4" id="text-org564f3e0">
<p>
Notes:
</p>
<ul class="org-ul">
<li>We can only load <code>scimax-jupyter</code> when we have <code>jupyter</code> on our <code>PATH</code>.
<ul class="org-ul">
<li>We assume <code>jupyter</code> is always installed in a virtual env associated with an <code>.envrc</code> file</li>
<li>We load jupyter when we activate <code>envrc-mode</code> if <code>jupyter</code> is available</li>
</ul></li>
<li>We need to add a <code>:session</code> to each code block
<ul class="org-ul">
<li>We can use the template <code>&lt;ha</code></li>
</ul></li>
<li>Use <code>:display plain</code> to remove clever displaying
<ul class="org-ul">
<li>We can use the template <code>&lt;dp</code></li>
</ul></li>
<li>Use <code>toggle-truncate-lines</code> when printing dataframes</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> scimax-jupyter
  <span class="org-builtin">:load-path</span> <span class="org-string">"~/git/scimax"</span>
  <span class="org-builtin">:bind</span>
  (<span class="org-builtin">:map</span> org-jupyter-mode-map
        (<span class="org-string">"&lt;localleader&gt;?"</span> . 'scimax-jupyter-org-hydra/body)
        (<span class="org-string">"&lt;localleader&gt;K"</span> . (<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>)
                              (scimax-jupyter-org-kill-kernel)
                              (<span class="org-keyword">setq</span> header-line-format nil)
                              (message <span class="org-string">"killer jupyter kernel"</span>))))
  <span class="org-builtin">:hook</span>
  (envrc-mode . lc/init-jupyter)
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">lc/init-jupyter</span> ()
    (<span class="org-keyword">interactive</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">only try to load in org-mode</span>
    (<span class="org-keyword">unless</span> (<span class="org-keyword">and</span> (fboundp 'org-babel-load-languages) (member '(jupyter . t) org-babel-load-languages))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">only load if jupyter is available</span>
        (<span class="org-keyword">if</span> (executable-find <span class="org-string">"jupyter"</span>)
            (<span class="org-keyword">let</span> ((warning-minimum-level <span class="org-builtin">:error</span>))
              (<span class="org-keyword">require</span> '<span class="org-constant">scimax-jupyter</span>))
          (message <span class="org-string">"could not initialize scimax-jupyter!"</span>))))
  <span class="org-builtin">:init</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(cl-defmethod jupyter-org--insert-result (_req context result)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((str</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(org-element-interpret-data</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(jupyter-org--wrap-result-maybe</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">context (if (jupyter-org--stream-result-p result)</span>
  <span class="org-comment-delimiter">;;                        </span><span class="org-comment">(thread-last result</span>
  <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">jupyter-org-strip-last-newline</span>
  <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">jupyter-org-scalar)</span>
  <span class="org-comment-delimiter">;;                      </span><span class="org-comment">result)))))</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(if (&lt; (length str) 100000)  ;; &gt;</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(insert str)</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(insert (format ": Result was too long! Length was %d" (length str)))))</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(when (/= (point) (line-beginning-position))</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(insert "\n")))</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">scimax-jupyter-get-session</span> ()
    <span class="org-doc">"Get the session name in the current buffer."</span>
    (<span class="org-keyword">let</span> ((lang (car (org-babel-get-src-block-info))))
      (<span class="org-keyword">or</span>
       (cdr
        (assoc <span class="org-builtin">:session</span>
               <span class="org-comment-delimiter">;; </span><span class="org-comment">NOTE: replaced '</span><span class="org-comment"><span class="org-constant">cadr</span></span><span class="org-comment">' with '</span><span class="org-comment"><span class="org-constant">car</span></span><span class="org-comment">' here</span>
               (car (org-babel-params-from-properties lang))))
       (cdr (assoc <span class="org-builtin">:session</span>
                   org-babel-default-header-args:jupyter-python)))))

  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga6b5ef1" class="outline-3">
<h3 id="orga6b5ef1">Stan</h3>
<div class="outline-text-3" id="text-orga6b5ef1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> stan-mode
  <span class="org-builtin">:mode</span> (<span class="org-string">"\\.stan\\'"</span> . stan-mode)
  <span class="org-builtin">:hook</span> (stan-mode . stan-mode-setup)
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">The officially recommended offset is 2.</span>
  (<span class="org-keyword">setq</span> stan-indentation-offset 2))
</pre>
</div>
</div>
</div>

<div id="outline-container-org04df69f" class="outline-3">
<h3 id="org04df69f">Javascript</h3>
<div class="outline-text-3" id="text-org04df69f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> rjsx-mode
  <span class="org-builtin">:hook</span> (rjsx-mode . rainbow-delimiters-mode)
  )

(<span class="org-keyword">use-package</span> typescript-mode
  <span class="org-builtin">:mode</span> <span class="org-string">"</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">.ts</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">'"</span>
  <span class="org-builtin">:hook</span> (typescript-mode . rainbow-delimiters-mode)
  <span class="org-builtin">:hook</span> (typescript-mode . lsp-deferred)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:hook (typescript-tsx-mode . rainbow-delimiters-mode)</span>
  <span class="org-builtin">:hook</span> (typescript-mode . (<span class="org-keyword">lambda</span> () (lsp-deferred) (lsp-diagnostics-mode -1)))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">define-derived-mode</span> <span class="org-function-name">typescript-tsx-mode</span> typescript-mode <span class="org-string">"TypeScript[tsx]"</span>)
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.tsx\\'"</span> . typescript-tsx-mode))
  (add-hook 'typescript-tsx-mode-hook
            (<span class="org-keyword">lambda</span> () (tree-sitter-mode) (tree-sitter-hl-mode)))
  <span class="org-builtin">:config</span> (<span class="org-keyword">setq</span> typescript-indent-level 2)
)

(<span class="org-keyword">use-package</span> flymake-eslint
  <span class="org-builtin">:hook</span>
  (typescript-mode . (<span class="org-keyword">lambda</span> ()
                       (flymake-eslint-enable)
                       (<span class="org-keyword">setq-local</span> flymake-eslint-project-root (locate-dominating-file buffer-file-name <span class="org-string">"tsconfig.json"</span>))))
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org4659569" class="outline-3">
<h3 id="org4659569">markdown</h3>
<div class="outline-text-3" id="text-org4659569">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> markdown-mode
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> setq t)
  (<span class="org-keyword">setq</span> markdown-enable-html t)
  (add-hook 'markdown-mode-hook #'conditionally-turn-on-pandoc)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org1b1546b" class="outline-3">
<h3 id="org1b1546b">yaml</h3>
<div class="outline-text-3" id="text-org1b1546b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">use-package</span> yaml-mode)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6f89912" class="outline-2">
<h2 id="org6f89912">To be fixed</h2>
<div class="outline-text-2" id="text-org6f89912">
</div>
<div id="outline-container-org60cfc85" class="outline-3">
<h3 id="org60cfc85"><span class="todo TODO">TODO</span> update README</h3>
</div>
<div id="outline-container-org4aa45f5" class="outline-3">
<h3 id="org4aa45f5"><span class="todo TODO">TODO</span> fix welcome-dashboard</h3>
</div>
<div id="outline-container-org192e8ae" class="outline-3">
<h3 id="org192e8ae"><span class="todo TODO">TODO</span> fix centaur tabs groups</h3>
</div>
</div>

  </section>
</article>

    </main>

    <footer class="py-10 print:hidden">
      
      <div class="flex justify-between">
  <div>
    <p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
      Luca Cambiaghi
    </p>
    <p class="text-xs text-neutral-500 dark:text-neutral-400">Theme inspired by
      <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://git.io/hugo-congo" target=_blank rel="noopener noreferrer">Congo</a>
    </p>
  </div>
  <div class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14">
    <button id=appearance-switcher class="w-12 h-12" type=button title="Switch to dark appearance">
      <span class="inline dark:hidden"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></span><span class="hidden dark:inline"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></span></button></div></div>

      
    </footer>

  </body>
</html>
